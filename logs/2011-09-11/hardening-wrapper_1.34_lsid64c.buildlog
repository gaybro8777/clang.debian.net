DC-Build-Header: hardening-wrapper 1.34 / Sun Sep 11 16:23:56 +0200 2011
sbuild (Debian sbuild) 0.62.2 (05 Apr 2011) on talc-110.nancy.grid5000.fr

╔══════════════════════════════════════════════════════════════════════════════╗
║ hardening-wrapper 1.34 (amd64)                             11 Sep 2011 16:23 ║
╚══════════════════════════════════════════════════════════════════════════════╝

Package: hardening-wrapper
Version: 1.34
Source Version: 1.34
Distribution: lsid64c
Architecture: amd64


┌──────────────────────────────────────────────────────────────────────────────┐
│ Update chroot                                                                │
└──────────────────────────────────────────────────────────────────────────────┘

Ign http://localhost sid InRelease
Hit http://localhost sid Release.gpg
Hit http://localhost sid Release
Ign http://localhost sid/main Sources/DiffIndex
Ign http://localhost sid/main amd64 Packages/DiffIndex
Ign http://localhost sid/main TranslationIndex
Hit http://localhost sid/main Sources
Hit http://localhost sid/main amd64 Packages
Ign http://localhost sid/main Translation-en
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following packages will be upgraded:
  binutils cpp-4.6 g++-4.6 gcc-4.6 gcc-4.6-base libc-bin libc-dev-bin libc6
  libc6-dev libgcc1 libgomp1 libquadmath0 libstdc++6 libstdc++6-4.6-dev
  multiarch-support
15 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 34.4 MB of archives.
After this operation, 1073 kB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libc6-dev libc-dev-bin libgomp1 gcc-4.6-base libgcc1 cpp-4.6 libquadmath0
  libstdc++6-4.6-dev g++-4.6 gcc-4.6 libstdc++6 binutils libc-bin libc6
  multiarch-support
Authentication warning overridden.
Get:1 http://localhost/debian/ sid/main libc6-dev amd64 2.13-20 [2637 kB]
Get:2 http://localhost/debian/ sid/main libc-dev-bin amd64 2.13-20 [217 kB]
Get:3 http://localhost/debian/ sid/main libgomp1 amd64 4.6.1-10 [25.7 kB]
Get:4 http://localhost/debian/ sid/main gcc-4.6-base amd64 4.6.1-10 [135 kB]
Get:5 http://localhost/debian/ sid/main libgcc1 amd64 1:4.6.1-10 [42.9 kB]
Get:6 http://localhost/debian/ sid/main cpp-4.6 amd64 4.6.1-10 [4816 kB]
Get:7 http://localhost/debian/ sid/main libquadmath0 amd64 4.6.1-10 [126 kB]
Get:8 http://localhost/debian/ sid/main libstdc++6-4.6-dev amd64 4.6.1-10 [1660 kB]
Get:9 http://localhost/debian/ sid/main g++-4.6 amd64 4.6.1-10 [6952 kB]
Get:10 http://localhost/debian/ sid/main gcc-4.6 amd64 4.6.1-10 [7303 kB]
Get:11 http://localhost/debian/ sid/main libstdc++6 amd64 4.6.1-10 [337 kB]
Get:12 http://localhost/debian/ sid/main binutils amd64 2.21.53.20110910-1 [4844 kB]
Get:13 http://localhost/debian/ sid/main libc-bin amd64 2.13-20 [819 kB]
Get:14 http://localhost/debian/ sid/main libc6 amd64 2.13-20 [4323 kB]
Get:15 http://localhost/debian/ sid/main multiarch-support amd64 2.13-20 [141 kB]
Preconfiguring packages ...
Fetched 34.4 MB in 0s (45.7 MB/s)
(Reading database ... 10788 files and directories currently installed.)
Preparing to replace libc6-dev 2.13-18 (using .../libc6-dev_2.13-20_amd64.deb) ...
Unpacking replacement libc6-dev ...
Preparing to replace libc-dev-bin 2.13-18 (using .../libc-dev-bin_2.13-20_amd64.deb) ...
Unpacking replacement libc-dev-bin ...
Preparing to replace libgomp1 4.6.1-9 (using .../libgomp1_4.6.1-10_amd64.deb) ...
Unpacking replacement libgomp1 ...
Preparing to replace gcc-4.6-base 4.6.1-9 (using .../gcc-4.6-base_4.6.1-10_amd64.deb) ...
Unpacking replacement gcc-4.6-base ...
Setting up gcc-4.6-base (4.6.1-10) ...
(Reading database ... 10788 files and directories currently installed.)
Preparing to replace libgcc1 1:4.6.1-9 (using .../libgcc1_1%3a4.6.1-10_amd64.deb) ...
Unpacking replacement libgcc1 ...
Setting up libgcc1 (1:4.6.1-10) ...
(Reading database ... 10788 files and directories currently installed.)
Preparing to replace cpp-4.6 4.6.1-9 (using .../cpp-4.6_4.6.1-10_amd64.deb) ...
Unpacking replacement cpp-4.6 ...
Preparing to replace libquadmath0 4.6.1-9 (using .../libquadmath0_4.6.1-10_amd64.deb) ...
Unpacking replacement libquadmath0 ...
Preparing to replace libstdc++6-4.6-dev 4.6.1-9 (using .../libstdc++6-4.6-dev_4.6.1-10_amd64.deb) ...
Unpacking replacement libstdc++6-4.6-dev ...
Preparing to replace g++-4.6 4.6.1-9 (using .../g++-4.6_4.6.1-10_amd64.deb) ...
Unpacking replacement g++-4.6 ...
Preparing to replace gcc-4.6 4.6.1-9 (using .../gcc-4.6_4.6.1-10_amd64.deb) ...
Unpacking replacement gcc-4.6 ...
Preparing to replace libstdc++6 4.6.1-9 (using .../libstdc++6_4.6.1-10_amd64.deb) ...
Unpacking replacement libstdc++6 ...
Setting up libstdc++6 (4.6.1-10) ...
(Reading database ... 10801 files and directories currently installed.)
Preparing to replace binutils 2.21.53.20110823-3 (using .../binutils_2.21.53.20110910-1_amd64.deb) ...
Unpacking replacement binutils ...
Preparing to replace libc-bin 2.13-18 (using .../libc-bin_2.13-20_amd64.deb) ...
Unpacking replacement libc-bin ...
Setting up libc-bin (2.13-20) ...
(Reading database ... 10801 files and directories currently installed.)
Preparing to replace libc6 2.13-18 (using .../libc6_2.13-20_amd64.deb) ...
Unpacking replacement libc6 ...
Setting up libc6 (2.13-20) ...
(Reading database ... 10801 files and directories currently installed.)
Preparing to replace multiarch-support 2.13-18 (using .../multiarch-support_2.13-20_amd64.deb) ...
Unpacking replacement multiarch-support ...
Setting up multiarch-support (2.13-20) ...
Setting up libc-dev-bin (2.13-20) ...
Setting up libc6-dev (2.13-20) ...
Setting up libgomp1 (4.6.1-10) ...
Setting up cpp-4.6 (4.6.1-10) ...
Setting up libquadmath0 (4.6.1-10) ...
Setting up binutils (2.21.53.20110910-1) ...
Setting up gcc-4.6 (4.6.1-10) ...
Setting up libstdc++6-4.6-dev (4.6.1-10) ...
Setting up g++-4.6 (4.6.1-10) ...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Fetch source files                                                           │
└──────────────────────────────────────────────────────────────────────────────┘


Check APT
─────────

Checking available source versions...

Download source files with APT
──────────────────────────────

Reading package lists...
Building dependency tree...
Reading state information...
NOTICE: 'hardening-wrapper' packaging is maintained in the 'Bzr' version control system at:
http://anonscm.debian.org/bzr/hardening/master
Please use:
bzr get http://anonscm.debian.org/bzr/hardening/master
to retrieve the latest (possibly unreleased) updates to the package.
Need to get 18.4 kB of source archives.
Get:1 http://localhost/debian/ sid/main hardening-wrapper 1.34 (dsc) [1724 B]
Get:2 http://localhost/debian/ sid/main hardening-wrapper 1.34 (tar) [16.6 kB]
Fetched 18.4 kB in 0s (158 kB/s)
Download complete and in download only mode

Check arch
──────────

Merged Build-Depends: build-essential, fakeroot
Filtered Build-Depends: build-essential, fakeroot
dpkg-deb: building package `sbuild-build-depends-core-dummy' in `/build/hardening-wrapper-R3AL0s/resolver-gMEOhE/apt_archive/sbuild-build-depends-core-dummy.deb'.
OK
Reading package lists...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Install core build dependencies (apt-based resolver)                         │
└──────────────────────────────────────────────────────────────────────────────┘

Installing build dependencies
Reading package lists...
Building dependency tree...
Reading state information...
The following NEW packages will be installed:
  sbuild-build-depends-core-dummy
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B/702 B of archives.
After this operation, 0 B of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  sbuild-build-depends-core-dummy
Authentication warning overridden.
Selecting previously deselected package sbuild-build-depends-core-dummy.
(Reading database ... 10801 files and directories currently installed.)
Unpacking sbuild-build-depends-core-dummy (from .../sbuild-build-depends-core-dummy.deb) ...
Setting up sbuild-build-depends-core-dummy (0.invalid.0) ...
Cannot open /var/lib/schroot/mount/lsid64c-8d2cf2f5-0d98-4842-83d5-984c6405c34e/etc/lsb-release: No such file or directory
Merged Build-Depends: base-files, base-passwd, bash, coreutils, dash, debianutils, diffutils, dpkg, e2fsprogs, findutils, grep, gzip, hostname, ncurses-base, ncurses-bin, perl-base, sed, login, sysvinit-utils, sysvinit, tar, bsdutils, mount, util-linux, libc6-dev | libc-dev, gcc (>= 4:4.4.3), g++ (>= 4:4.4.3), make, dpkg-dev (>= 1.13.5), debhelper (>= 7)
Filtered Build-Depends: base-files, base-passwd, bash, coreutils, dash, debianutils, diffutils, dpkg, e2fsprogs, findutils, grep, gzip, hostname, ncurses-base, ncurses-bin, perl-base, sed, login, sysvinit-utils, sysvinit, tar, bsdutils, mount, util-linux, libc6-dev, gcc (>= 4:4.4.3), g++ (>= 4:4.4.3), make, dpkg-dev (>= 1.13.5), debhelper (>= 7)
dpkg-deb: building package `sbuild-build-depends-hardening-wrapper-dummy' in `/build/hardening-wrapper-R3AL0s/resolver-BFIfPD/apt_archive/sbuild-build-depends-hardening-wrapper-dummy.deb'.
OK
Reading package lists...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Install hardening-wrapper build dependencies (apt-based resolver)            │
└──────────────────────────────────────────────────────────────────────────────┘

Installing build dependencies
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  bsdmainutils debhelper file gettext gettext-base groff-base html2text
  intltool-debian libcroco3 libglib2.0-0 libmagic1 libpcre3 libpipeline1
  libunistring0 libxml2 man-db po-debconf
Suggested packages:
  wamerican wordlist whois vacation dh-make gettext-doc groff www-browser
  libmail-box-perl
Recommended packages:
  curl wget lynx-cur autopoint libglib2.0-data shared-mime-info xml-core
  libmail-sendmail-perl
The following NEW packages will be installed:
  bsdmainutils debhelper file gettext gettext-base groff-base html2text
  intltool-debian libcroco3 libglib2.0-0 libmagic1 libpcre3 libpipeline1
  libunistring0 libxml2 man-db po-debconf
  sbuild-build-depends-hardening-wrapper-dummy
0 upgraded, 18 newly installed, 0 to remove and 0 not upgraded.
Need to get 9196 kB/9197 kB of archives.
After this operation, 27.3 MB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libpipeline1 libpcre3 bsdmainutils groff-base man-db libmagic1 file
  gettext-base libxml2 html2text libglib2.0-0 libcroco3 libunistring0 gettext
  intltool-debian po-debconf debhelper
  sbuild-build-depends-hardening-wrapper-dummy
Authentication warning overridden.
Get:1 http://localhost/debian/ sid/main libpipeline1 amd64 1.2.0-3 [37.9 kB]
Get:2 http://localhost/debian/ sid/main libpcre3 amd64 8.12-4 [225 kB]
Get:3 http://localhost/debian/ sid/main bsdmainutils amd64 8.2.3 [208 kB]
Get:4 http://localhost/debian/ sid/main groff-base amd64 1.21-6 [1150 kB]
Get:5 http://localhost/debian/ sid/main man-db amd64 2.6.0.2-2 [1023 kB]
Get:6 http://localhost/debian/ sid/main libmagic1 amd64 5.08-1 [246 kB]
Get:7 http://localhost/debian/ sid/main file amd64 5.08-1 [51.7 kB]
Get:8 http://localhost/debian/ sid/main gettext-base amd64 0.18.1.1-4 [154 kB]
Get:9 http://localhost/debian/ sid/main libxml2 amd64 2.7.8.dfsg-4 [892 kB]
Get:10 http://localhost/debian/ sid/main html2text amd64 1.3.2a-15 [103 kB]
Get:11 http://localhost/debian/ sid/main libglib2.0-0 amd64 2.28.6-1 [1648 kB]
Get:12 http://localhost/debian/ sid/main libcroco3 amd64 0.6.2-1 [125 kB]
Get:13 http://localhost/debian/ sid/main libunistring0 amd64 0.9.3-4 [437 kB]
Get:14 http://localhost/debian/ sid/main gettext amd64 0.18.1.1-4 [2079 kB]
Get:15 http://localhost/debian/ sid/main intltool-debian all 0.35.0+20060710.1 [30.8 kB]
Get:16 http://localhost/debian/ sid/main po-debconf all 1.0.16+nmu1 [223 kB]
Get:17 http://localhost/debian/ sid/main debhelper all 8.9.6 [562 kB]
Preconfiguring packages ...
Fetched 9196 kB in 0s (26.0 MB/s)
Selecting previously deselected package libpipeline1.
(Reading database ... 10801 files and directories currently installed.)
Unpacking libpipeline1 (from .../libpipeline1_1.2.0-3_amd64.deb) ...
Selecting previously deselected package libpcre3.
Unpacking libpcre3 (from .../libpcre3_8.12-4_amd64.deb) ...
Selecting previously deselected package bsdmainutils.
Unpacking bsdmainutils (from .../bsdmainutils_8.2.3_amd64.deb) ...
Selecting previously deselected package groff-base.
Unpacking groff-base (from .../groff-base_1.21-6_amd64.deb) ...
Selecting previously deselected package man-db.
Unpacking man-db (from .../man-db_2.6.0.2-2_amd64.deb) ...
Selecting previously deselected package libmagic1.
Unpacking libmagic1 (from .../libmagic1_5.08-1_amd64.deb) ...
Selecting previously deselected package file.
Unpacking file (from .../archives/file_5.08-1_amd64.deb) ...
Selecting previously deselected package gettext-base.
Unpacking gettext-base (from .../gettext-base_0.18.1.1-4_amd64.deb) ...
Selecting previously deselected package libxml2.
Unpacking libxml2 (from .../libxml2_2.7.8.dfsg-4_amd64.deb) ...
Selecting previously deselected package html2text.
Unpacking html2text (from .../html2text_1.3.2a-15_amd64.deb) ...
Selecting previously deselected package libglib2.0-0.
Unpacking libglib2.0-0 (from .../libglib2.0-0_2.28.6-1_amd64.deb) ...
Selecting previously deselected package libcroco3.
Unpacking libcroco3 (from .../libcroco3_0.6.2-1_amd64.deb) ...
Selecting previously deselected package libunistring0.
Unpacking libunistring0 (from .../libunistring0_0.9.3-4_amd64.deb) ...
Selecting previously deselected package gettext.
Unpacking gettext (from .../gettext_0.18.1.1-4_amd64.deb) ...
Selecting previously deselected package intltool-debian.
Unpacking intltool-debian (from .../intltool-debian_0.35.0+20060710.1_all.deb) ...
Selecting previously deselected package po-debconf.
Unpacking po-debconf (from .../po-debconf_1.0.16+nmu1_all.deb) ...
Selecting previously deselected package debhelper.
Unpacking debhelper (from .../debhelper_8.9.6_all.deb) ...
Selecting previously deselected package sbuild-build-depends-hardening-wrapper-dummy.
Unpacking sbuild-build-depends-hardening-wrapper-dummy (from .../sbuild-build-depends-hardening-wrapper-dummy.deb) ...
Processing triggers for install-info ...
Setting up libpipeline1 (1.2.0-3) ...
Setting up libpcre3 (8.12-4) ...
Setting up bsdmainutils (8.2.3) ...
update-alternatives: using /usr/bin/bsd-write to provide /usr/bin/write (write) in auto mode.
update-alternatives: using /usr/bin/bsd-from to provide /usr/bin/from (from) in auto mode.
Setting up groff-base (1.21-6) ...
Setting up man-db (2.6.0.2-2) ...
Building database of manual pages ...
Setting up libmagic1 (5.08-1) ...
Setting up file (5.08-1) ...
Setting up gettext-base (0.18.1.1-4) ...
Setting up libxml2 (2.7.8.dfsg-4) ...
Setting up html2text (1.3.2a-15) ...
Setting up libglib2.0-0 (2.28.6-1) ...
No schema files found: doing nothing.
Setting up libcroco3 (0.6.2-1) ...
Setting up libunistring0 (0.9.3-4) ...
Setting up gettext (0.18.1.1-4) ...
Setting up intltool-debian (0.35.0+20060710.1) ...
Setting up po-debconf (1.0.16+nmu1) ...
Setting up debhelper (8.9.6) ...
Setting up sbuild-build-depends-hardening-wrapper-dummy (0.invalid.0) ...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Build environment                                                            │
└──────────────────────────────────────────────────────────────────────────────┘

Kernel: Linux 2.6.32-5-amd64 amd64 (x86_64)
Toolchain package versions: binutils_2.21.53.20110910-1 dpkg-dev_1.16.0.3 g++-4.6_4.6.1-10 gcc-4.6_4.6.1-10 libc6-dev_2.13-20 libstdc++6_4.6.1-10 libstdc++6-4.6-dev_4.6.1-10 linux-libc-dev_3.0.0-3
Package versions: apt_0.8.15.6 apt-utils_0.8.15.6 base-files_6.5 base-passwd_3.5.23 bash_4.1-3 binutils_2.21.53.20110910-1 bsdmainutils_8.2.3 bsdutils_1:2.19.1-5 build-essential_11.5 bzip2_1.0.5-7 clang_2.9-11 coreutils_8.5-1 cpp_4:4.6.1-2 cpp-4.6_4.6.1-10 dash_0.5.7-1 debconf_1.5.41 debfoster_2.7-1.1 debhelper_8.9.6 debian-archive-keyring_2010.08.28 debianutils_4.0.2 diffutils_1:3.0-1 dpkg_1.16.0.3 dpkg-dev_1.16.0.3 e2fslibs_1.42~WIP-2011-07-02-1 e2fsprogs_1.42~WIP-2011-07-02-1 fakeroot_1.18-1 file_5.08-1 findutils_4.4.2-1+b1 g++_4:4.6.1-2 g++-4.6_4.6.1-10 gcc_4:4.6.1-2 gcc-4.6_4.6.1-10 gcc-4.6-base_4.6.1-10 gettext_0.18.1.1-4 gettext-base_0.18.1.1-4 gnupg_1.4.11-3 gpgv_1.4.11-3 grep_2.9-2 groff-base_1.21-6 gzip_1.4-1 hostname_3.06 html2text_1.3.2a-15 initscripts_2.88dsf-13.11 insserv_1.14.0-2.1 install-info_4.13a.dfsg.1-8 intltool-debian_0.35.0+20060710.1 less_444-1 libacl1_2.2.51-3 libattr1_1:2.4.46-3 libblkid1_2.19.1-5 libbz2-1.0_1.0.5-7 libc-bin_2.13-20 libc-dev-bin_2.13-20 libc6_2.13-20 libc6-dev_2.13-20 libcomerr2_1.42~WIP-2011-07-02-1 libcroco3_0.6.2-1 libdb5.1_5.1.25-11 libdpkg-perl_1.16.0.3 libffi5_3.0.10~rc10-3 libgc1c2_1:7.1-8 libgcc1_1:4.6.1-10 libgdbm3_1.8.3-10 libglib2.0-0_2.28.6-1 libgmp10_2:5.0.2+dfsg-1 libgomp1_4.6.1-10 libllvm2.9_2.9+dfsg-3 liblzma2_5.1.1alpha+20110809-2 libmagic1_5.08-1 libmount1_2.19.1-5 libmpc2_0.9-3 libmpfr4_3.0.1-6 libncurses5_5.9-1 libncursesw5_5.9-1 libpam-modules_1.1.3-2 libpam-modules-bin_1.1.3-2 libpam-runtime_1.1.3-2 libpam0g_1.1.3-2 libpcre3_8.12-4 libpipeline1_1.2.0-3 libquadmath0_4.6.1-10 libreadline6_6.2-4 libselinux1_2.1.0-1 libsepol1_2.1.0-1.1 libslang2_2.2.4-3 libss2_1.42~WIP-2011-07-02-1 libstdc++6_4.6.1-10 libstdc++6-4.6-dev_4.6.1-10 libtimedate-perl_1.2000-1 libunistring0_0.9.3-4 libusb-0.1-4_2:0.1.12-19 libuuid1_2.19.1-5 libxml2_2.7.8.dfsg-4 linux-libc-dev_3.0.0-3 login_1:4.1.4.2+svn3283-3 lsb-base_3.2-28 make_3.81-8.1 man-db_2.6.0.2-2 mawk_1.3.3-15 mount_2.19.1-5 multiarch-support_2.13-20 ncurses-base_5.9-1 ncurses-bin_5.9-1 nvi_1.81.6-8.2 passwd_1:4.1.4.2+svn3283-3 patch_2.6.1-2 perl_5.12.4-4 perl-base_5.12.4-4 perl-modules_5.12.4-4 po-debconf_1.0.16+nmu1 readline-common_6.2-4 sbuild-build-depends-core-dummy_0.invalid.0 sbuild-build-depends-hardening-wrapper-dummy_0.invalid.0 sed_4.2.1-9 sensible-utils_0.0.6 sysv-rc_2.88dsf-13.11 sysvinit_2.88dsf-13.11 sysvinit-utils_2.88dsf-13.11 tar_1.26-2 tzdata_2011i-2 util-linux_2.19.1-5 xz-utils_5.1.1alpha+20110809-2 zlib1g_1:1.2.3.4.dfsg-3

┌──────────────────────────────────────────────────────────────────────────────┐
│ Build                                                                        │
└──────────────────────────────────────────────────────────────────────────────┘


Unpack source
─────────────

gpgv: keyblock resource `/var/lib/sbuild/.gnupg/trustedkeys.gpg': file open error
gpgv: Signature made Fri Jul 29 04:51:21 2011 CEST using RSA key ID DC6DC026
gpgv: Can't check signature: public key not found
dpkg-source: warning: failed to verify signature on ./hardening-wrapper_1.34.dsc
dpkg-source: info: extracting hardening-wrapper in hardening-wrapper-1.34
dpkg-source: info: unpacking hardening-wrapper_1.34.tar.gz

Check disc space
────────────────

Sufficient free space for build

dpkg-buildpackage
─────────────────

dpkg-buildpackage: export CFLAGS from dpkg-buildflags (origin: vendor): -g -O2
dpkg-buildpackage: export CPPFLAGS from dpkg-buildflags (origin: vendor): 
dpkg-buildpackage: export CXXFLAGS from dpkg-buildflags (origin: vendor): -g -O2
dpkg-buildpackage: export FFLAGS from dpkg-buildflags (origin: vendor): -g -O2
dpkg-buildpackage: export LDFLAGS from dpkg-buildflags (origin: vendor): 
dpkg-buildpackage: source package hardening-wrapper
dpkg-buildpackage: source version 1.34
 dpkg-source --before-build hardening-wrapper-1.34
dpkg-buildpackage: host architecture amd64
 fakeroot debian/rules clean
dh_testdir
dh_testroot
rm -f build-stamp test-stamp
rm -rf build-tree
rm -f hardened-c++.1 hardening-wrapper.1 hardening-check.1
dh_clean
 dpkg-source -b hardening-wrapper-1.34
dpkg-source: info: using source format `3.0 (native)'
dpkg-source: info: building hardening-wrapper in hardening-wrapper_1.34.tar.gz
dpkg-source: info: building hardening-wrapper in hardening-wrapper_1.34.dsc
 debian/rules build
# Building
dh_testdir
mkdir -p build-tree
install hardened-cc hardened-ld build-tree
# Set defaults, based on OS and ARCH
perl -pi -e 's/ #OS#/ '"linux"'/; s/ #ARCH#/ '"amd64"'/;' build-tree/hardened-cc build-tree/hardened-ld
perl -pi -e "s/default{'DEB_BUILD_HARDENING_PIE'}=1;/default{'DEB_BUILD_HARDENING_PIE'}=1;/;" build-tree/hardened-cc build-tree/hardened-ld
perl -pi -e "s/default{'DEB_BUILD_HARDENING_STACKPROTECTOR'}=1;/default{'DEB_BUILD_HARDENING_STACKPROTECTOR'}=1;/;" build-tree/hardened-cc build-tree/hardened-ld
# Duplicate cc wrapper to c++
cp build-tree/hardened-cc build-tree/hardened-c++
perl -pi -e 's/hardened-cc/hardened-c++/g; s|/usr/bin/cc|/usr/bin/c++|g;' build-tree/hardened-c++
# Set up man pages
ln -sf hardened-cc.1 hardening-wrapper.1
cp hardened-cc.1 hardened-c++.1
perl -pi -e 's/hardened-cc/hardened-c++/g; s/gcc/g++/g;' hardened-c++.1
pod2man hardening-check > hardening-check.1
# Done building
touch build-stamp
(cd tests; make check)
make[1]: Entering directory `/build/hardening-wrapper-R3AL0s/hardening-wrapper-1.34/tests'
# Check the stack protector and PIE options directly, just to have
# a historical record in the build logs.
cc -Wall -fstack-protector hello.c -o ../build-tree/cc-test || true
../build-tree/cc-test || true
../build-tree/cc-test: ok (0x4005b0)
cc -Wall -fPIE -pie hello.c -o ../build-tree/cc-test || true
../build-tree/cc-test || true
../build-tree/cc-test: ok (0x2b2181fe87d0)
../build-tree/cc-test || true
../build-tree/cc-test: ok (0x2b48a20a57d0)
make -f Makefile.wrapper check
make[2]: Entering directory `/build/hardening-wrapper-R3AL0s/hardening-wrapper-1.34/tests'
# Test basic perl syntax
for script in ../build-tree/hardened-cc ../build-tree/hardened-ld ../build-tree/hardened-c++; do perl -c $script; done
../build-tree/hardened-cc syntax OK
../build-tree/hardened-ld syntax OK
../build-tree/hardened-c++ syntax OK
touch syntax.stamp
# Compiler and linker options disabled.
DEB_BUILD_HARDENING=0 ../build-tree/hardened-cc -B ../build-tree/ -o ../build-tree/wrapper-test-stock hello.c
/usr/bin/clang -B ../build-tree/ -o ../build-tree/wrapper-test-stock hello.c
readelf -ldrsW ../build-tree/wrapper-test-stock

Elf file type is EXEC (Executable file)
Entry point 0x400450
There are 8 program headers, starting at offset 64

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  PHDR           0x000040 0x0000000000400040 0x0000000000400040 0x0001c0 0x0001c0 R E 0x8
  INTERP         0x000200 0x0000000000400200 0x0000000000400200 0x00001c 0x00001c R   0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x000000 0x0000000000400000 0x0000000000400000 0x0007fc 0x0007fc R E 0x200000
  LOAD           0x000800 0x0000000000600800 0x0000000000600800 0x000210 0x000220 RW  0x200000
  DYNAMIC        0x000828 0x0000000000600828 0x0000000000600828 0x0001a0 0x0001a0 RW  0x8
  NOTE           0x00021c 0x000000000040021c 0x000000000040021c 0x000044 0x000044 R   0x4
  GNU_EH_FRAME   0x0006dc 0x00000000004006dc 0x00000000004006dc 0x000034 0x000034 R   0x4
  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x8

 Section to Segment mapping:
  Segment Sections...
   00     
   01     .interp 
   02     .interp .note.ABI-tag .note.gnu.build-id .hash .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame 
   03     .ctors .dtors .jcr .dynamic .got .got.plt .data .bss 
   04     .dynamic 
   05     .note.ABI-tag .note.gnu.build-id 
   06     .eh_frame_hdr 
   07     

Dynamic section at offset 0x828 contains 21 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x4003f0
 0x000000000000000d (FINI)               0x4006b8
 0x0000000000000004 (HASH)               0x400260
 0x000000006ffffef5 (GNU_HASH)           0x400288
 0x0000000000000005 (STRTAB)             0x400320
 0x0000000000000006 (SYMTAB)             0x4002a8
 0x000000000000000a (STRSZ)              65 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000015 (DEBUG)              0x0
 0x0000000000000003 (PLTGOT)             0x6009d0
 0x0000000000000002 (PLTRELSZ)           72 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4003a8
 0x0000000000000007 (RELA)               0x400390
 0x0000000000000008 (RELASZ)             24 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x400370
 0x000000006fffffff (VERNEEDNUM)         1
 0x000000006ffffff0 (VERSYM)             0x400362
 0x0000000000000000 (NULL)               0x0

Relocation section '.rela.dyn' at offset 0x390 contains 1 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
00000000006009c8  0000000400000006 R_X86_64_GLOB_DAT      0000000000000000 __gmon_start__ + 0

Relocation section '.rela.plt' at offset 0x3a8 contains 3 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
00000000006009e8  0000000100000007 R_X86_64_JUMP_SLOT     0000000000000000 printf + 0
00000000006009f0  0000000200000007 R_X86_64_JUMP_SLOT     0000000000000000 snprintf + 0
00000000006009f8  0000000300000007 R_X86_64_JUMP_SLOT     0000000000000000 __libc_start_main + 0

Symbol table '.dynsym' contains 5 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.2.5 (2)
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND snprintf@GLIBC_2.2.5 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)
     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__

Symbol table '.symtab' contains 67 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000400200     0 SECTION LOCAL  DEFAULT    1 
     2: 000000000040021c     0 SECTION LOCAL  DEFAULT    2 
     3: 000000000040023c     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000400260     0 SECTION LOCAL  DEFAULT    4 
     5: 0000000000400288     0 SECTION LOCAL  DEFAULT    5 
     6: 00000000004002a8     0 SECTION LOCAL  DEFAULT    6 
     7: 0000000000400320     0 SECTION LOCAL  DEFAULT    7 
     8: 0000000000400362     0 SECTION LOCAL  DEFAULT    8 
     9: 0000000000400370     0 SECTION LOCAL  DEFAULT    9 
    10: 0000000000400390     0 SECTION LOCAL  DEFAULT   10 
    11: 00000000004003a8     0 SECTION LOCAL  DEFAULT   11 
    12: 00000000004003f0     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000400410     0 SECTION LOCAL  DEFAULT   13 
    14: 0000000000400450     0 SECTION LOCAL  DEFAULT   14 
    15: 00000000004006b8     0 SECTION LOCAL  DEFAULT   15 
    16: 00000000004006c8     0 SECTION LOCAL  DEFAULT   16 
    17: 00000000004006dc     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000400710     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000600800     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000600810     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000600820     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000600828     0 SECTION LOCAL  DEFAULT   22 
    23: 00000000006009c8     0 SECTION LOCAL  DEFAULT   23 
    24: 00000000006009d0     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000600a00     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000600a10     0 SECTION LOCAL  DEFAULT   26 
    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 
    28: 000000000040047c     0 FUNC    LOCAL  DEFAULT   14 call_gmon_start
    29: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    30: 0000000000600800     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_LIST__
    31: 0000000000600810     0 OBJECT  LOCAL  DEFAULT   20 __DTOR_LIST__
    32: 0000000000600820     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__
    33: 00000000004004a0     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    34: 0000000000600a10     1 OBJECT  LOCAL  DEFAULT   26 completed.5854
    35: 0000000000600a18     8 OBJECT  LOCAL  DEFAULT   26 dtor_idx.5856
    36: 0000000000400510     0 FUNC    LOCAL  DEFAULT   14 frame_dummy
    37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    38: 0000000000600808     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_END__
    39: 00000000004007f8     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__
    40: 0000000000600820     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__
    41: 0000000000400680     0 FUNC    LOCAL  DEFAULT   14 __do_global_ctors_aux
    42: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
    43: 00000000006007fc     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end
    44: 0000000000600828     0 OBJECT  LOCAL  DEFAULT   22 _DYNAMIC
    45: 00000000006007fc     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start
    46: 00000000006009d0     0 OBJECT  LOCAL  DEFAULT   24 _GLOBAL_OFFSET_TABLE_
    47: 00000000004005e0     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini
    48: 0000000000600a00     0 NOTYPE  WEAK   DEFAULT   25 data_start
    49: 0000000000600a10     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    50: 00000000004006b8     0 FUNC    GLOBAL DEFAULT   15 _fini
    51: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND printf@@GLIBC_2.2.5
    52: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND snprintf@@GLIBC_2.2.5
    53: 0000000000600818     0 OBJECT  GLOBAL HIDDEN    20 __DTOR_END__
    54: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_2.2.5
    55: 0000000000600a00     0 NOTYPE  GLOBAL DEFAULT   25 __data_start
    56: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    57: 0000000000600a08     0 OBJECT  GLOBAL HIDDEN    25 __dso_handle
    58: 0000000000400540    96 FUNC    GLOBAL DEFAULT   14 announcement
    59: 00000000004006c8     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
    60: 00000000004005f0   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    61: 0000000000600a20     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    62: 0000000000400450     0 FUNC    GLOBAL DEFAULT   14 _start
    63: 0000000000600a10     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    64: 00000000004005a0    57 FUNC    GLOBAL DEFAULT   14 main
    65: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    66: 00000000004003f0     0 FUNC    GLOBAL DEFAULT   12 _init
../build-tree/wrapper-test-stock
../build-tree/wrapper-test-stock: ok (0x400540)
# Compiler options enabled. (linker is not wrapper)
../build-tree/hardened-cc -B ../build-tree/ -g -O2 -O2  -o ../build-tree/wrapper-test-compiled hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -fPIE -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -g -O2 -O2 -o ../build-tree/wrapper-test-compiled hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
readelf -ldrsW ../build-tree/wrapper-test-compiled

Elf file type is DYN (Shared object file)
Entry point 0x770
There are 8 program headers, starting at offset 64

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  PHDR           0x000040 0x0000000000000040 0x0000000000000040 0x0001c0 0x0001c0 R E 0x8
  INTERP         0x000200 0x0000000000000200 0x0000000000000200 0x00001c 0x00001c R   0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x000b84 0x000b84 R E 0x200000
  LOAD           0x000b88 0x0000000000200b88 0x0000000000200b88 0x000250 0x000260 RW  0x200000
  DYNAMIC        0x000bb0 0x0000000000200bb0 0x0000000000200bb0 0x0001a0 0x0001a0 RW  0x8
  NOTE           0x00021c 0x000000000000021c 0x000000000000021c 0x000044 0x000044 R   0x4
  GNU_EH_FRAME   0x000a7c 0x0000000000000a7c 0x0000000000000a7c 0x000034 0x000034 R   0x4
  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x8

 Section to Segment mapping:
  Segment Sections...
   00     
   01     .interp 
   02     .interp .note.ABI-tag .note.gnu.build-id .hash .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame 
   03     .ctors .dtors .jcr .dynamic .got .got.plt .data .bss 
   04     .dynamic 
   05     .note.ABI-tag .note.gnu.build-id 
   06     .eh_frame_hdr 
   07     

Dynamic section at offset 0xbb0 contains 22 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x6f8
 0x000000000000000d (FINI)               0xa58
 0x0000000000000004 (HASH)               0x260
 0x000000006ffffef5 (GNU_HASH)           0x2b8
 0x0000000000000005 (STRTAB)             0x478
 0x0000000000000006 (SYMTAB)             0x2f8
 0x000000000000000a (STRSZ)              227 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000015 (DEBUG)              0x0
 0x0000000000000003 (PLTGOT)             0x200d88
 0x0000000000000002 (PLTRELSZ)           120 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x680
 0x0000000000000007 (RELA)               0x5c0
 0x0000000000000008 (RELASZ)             192 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x580
 0x000000006fffffff (VERNEEDNUM)         1
 0x000000006ffffff0 (VERSYM)             0x55c
 0x000000006ffffff9 (RELACOUNT)          5
 0x0000000000000000 (NULL)               0x0

Relocation section '.rela.dyn' at offset 0x5c0 contains 8 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200d50  0000000000000008 R_X86_64_RELATIVE                               0000000000000980
0000000000200d60  0000000000000008 R_X86_64_RELATIVE                               0000000000000870
0000000000200d68  0000000000000008 R_X86_64_RELATIVE                               0000000000000990
0000000000200d70  0000000000000008 R_X86_64_RELATIVE                               00000000000008f0
0000000000200dd0  0000000000000008 R_X86_64_RELATIVE                               0000000000200dd0
0000000000200d58  0000000500000006 R_X86_64_GLOB_DAT      0000000000000000 __gmon_start__ + 0
0000000000200d78  0000000700000006 R_X86_64_GLOB_DAT      0000000000000000 _Jv_RegisterClasses + 0
0000000000200d80  0000000800000006 R_X86_64_GLOB_DAT      0000000000000000 __cxa_finalize + 0

Relocation section '.rela.plt' at offset 0x680 contains 5 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200da0  0000000200000007 R_X86_64_JUMP_SLOT     0000000000000000 __snprintf_chk + 0
0000000000200da8  0000000300000007 R_X86_64_JUMP_SLOT     0000000000000000 __stack_chk_fail + 0
0000000000200db0  0000000400000007 R_X86_64_JUMP_SLOT     0000000000000000 __libc_start_main + 0
0000000000200db8  0000000600000007 R_X86_64_JUMP_SLOT     0000000000000000 __printf_chk + 0
0000000000200dc0  0000000800000007 R_X86_64_JUMP_SLOT     0000000000000000 __cxa_finalize + 0

Symbol table '.dynsym' contains 16 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000200     0 SECTION LOCAL  DEFAULT    1 
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@GLIBC_2.3.4 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@GLIBC_2.4 (3)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (4)
     5: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@GLIBC_2.3.4 (2)
     7: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
     8: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (4)
     9: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    10: 0000000000000870   126 FUNC    GLOBAL DEFAULT   14 announcement
    11: 0000000000200de8     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    12: 0000000000000990   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    13: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    14: 00000000000008f0   134 FUNC    GLOBAL DEFAULT   14 main
    15: 0000000000000980     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini

Symbol table '.symtab' contains 76 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000200     0 SECTION LOCAL  DEFAULT    1 
     2: 000000000000021c     0 SECTION LOCAL  DEFAULT    2 
     3: 000000000000023c     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000000260     0 SECTION LOCAL  DEFAULT    4 
     5: 00000000000002b8     0 SECTION LOCAL  DEFAULT    5 
     6: 00000000000002f8     0 SECTION LOCAL  DEFAULT    6 
     7: 0000000000000478     0 SECTION LOCAL  DEFAULT    7 
     8: 000000000000055c     0 SECTION LOCAL  DEFAULT    8 
     9: 0000000000000580     0 SECTION LOCAL  DEFAULT    9 
    10: 00000000000005c0     0 SECTION LOCAL  DEFAULT   10 
    11: 0000000000000680     0 SECTION LOCAL  DEFAULT   11 
    12: 00000000000006f8     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000000710     0 SECTION LOCAL  DEFAULT   13 
    14: 0000000000000770     0 SECTION LOCAL  DEFAULT   14 
    15: 0000000000000a58     0 SECTION LOCAL  DEFAULT   15 
    16: 0000000000000a68     0 SECTION LOCAL  DEFAULT   16 
    17: 0000000000000a7c     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000000ab0     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000200b88     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000200b98     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000200ba8     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000200bb0     0 SECTION LOCAL  DEFAULT   22 
    23: 0000000000200d50     0 SECTION LOCAL  DEFAULT   23 
    24: 0000000000200d88     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000200dc8     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000200dd8     0 SECTION LOCAL  DEFAULT   26 
    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 
    28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28 
    29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29 
    30: 0000000000000000     0 SECTION LOCAL  DEFAULT   30 
    31: 0000000000000000     0 SECTION LOCAL  DEFAULT   31 
    32: 0000000000000000     0 SECTION LOCAL  DEFAULT   32 
    33: 0000000000000000     0 SECTION LOCAL  DEFAULT   33 
    34: 0000000000000000     0 SECTION LOCAL  DEFAULT   34 
    35: 000000000000079c     0 FUNC    LOCAL  DEFAULT   14 call_gmon_start
    36: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    37: 0000000000200b88     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_LIST__
    38: 0000000000200b98     0 OBJECT  LOCAL  DEFAULT   20 __DTOR_LIST__
    39: 0000000000200ba8     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__
    40: 00000000000007c0     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    41: 0000000000200dd8     1 OBJECT  LOCAL  DEFAULT   26 completed.5854
    42: 0000000000200de0     8 OBJECT  LOCAL  DEFAULT   26 dtor_idx.5856
    43: 0000000000000840     0 FUNC    LOCAL  DEFAULT   14 frame_dummy
    44: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    45: 0000000000200b90     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_END__
    46: 0000000000000b80     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__
    47: 0000000000200ba8     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__
    48: 0000000000000a20     0 FUNC    LOCAL  DEFAULT   14 __do_global_ctors_aux
    49: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
    50: 0000000000200b84     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end
    51: 0000000000200bb0     0 OBJECT  LOCAL  DEFAULT  ABS _DYNAMIC
    52: 0000000000200b84     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start
    53: 0000000000200d88     0 OBJECT  LOCAL  DEFAULT  ABS _GLOBAL_OFFSET_TABLE_
    54: 0000000000000980     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini
    55: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@@GLIBC_2.3.4
    56: 0000000000200dc8     0 NOTYPE  WEAK   DEFAULT   25 data_start
    57: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    58: 0000000000000a58     0 FUNC    GLOBAL DEFAULT   15 _fini
    59: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@@GLIBC_2.4
    60: 0000000000200ba0     0 OBJECT  GLOBAL HIDDEN    20 __DTOR_END__
    61: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_2.2.5
    62: 0000000000200dc8     0 NOTYPE  GLOBAL DEFAULT   25 __data_start
    63: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    64: 0000000000200dd0     0 OBJECT  GLOBAL HIDDEN    25 __dso_handle
    65: 0000000000000870   126 FUNC    GLOBAL DEFAULT   14 announcement
    66: 0000000000000a68     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
    67: 0000000000000990   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    68: 0000000000200de8     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    69: 0000000000000770     0 FUNC    GLOBAL DEFAULT   14 _start
    70: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    71: 00000000000008f0   134 FUNC    GLOBAL DEFAULT   14 main
    72: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@@GLIBC_2.3.4
    73: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    74: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2.5
    75: 00000000000006f8     0 FUNC    GLOBAL DEFAULT   12 _init
# Run twice to show off PIE, if available in kernel
../build-tree/wrapper-test-compiled
../build-tree/wrapper-test-compiled: ok (0x2b3d2a18e870)
../build-tree/wrapper-test-compiled
../build-tree/wrapper-test-compiled: ok (0x2b63bfe68870)
# Enable symlink for ld to trick gcc into doing wrapped linking
(cd ../build-tree && ln -s hardened-ld ld)
(cd ../build-tree && ln -s hardened-ld ld.gold)
# Compiler and linker options enabled.
../build-tree/hardened-cc -B ../build-tree/ -g -O2 -O2  -o ../build-tree/wrapper-test-linked hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -fPIE -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -g -O2 -O2 -o ../build-tree/wrapper-test-linked hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-linked /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu /tmp/cc-NDc9R3.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
readelf -ldrsW ../build-tree/wrapper-test-linked

Elf file type is DYN (Shared object file)
Entry point 0x7b0
There are 9 program headers, starting at offset 64

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  PHDR           0x000040 0x0000000000000040 0x0000000000000040 0x0001f8 0x0001f8 R E 0x8
  INTERP         0x000238 0x0000000000000238 0x0000000000000238 0x00001c 0x00001c R   0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x000bc4 0x000bc4 R E 0x200000
  LOAD           0x000da0 0x0000000000200da0 0x0000000000200da0 0x000270 0x000280 RW  0x200000
  DYNAMIC        0x000dc8 0x0000000000200dc8 0x0000000000200dc8 0x0001c0 0x0001c0 RW  0x8
  NOTE           0x000254 0x0000000000000254 0x0000000000000254 0x000044 0x000044 R   0x4
  GNU_EH_FRAME   0x000abc 0x0000000000000abc 0x0000000000000abc 0x000034 0x000034 R   0x4
  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x8
  GNU_RELRO      0x000da0 0x0000000000200da0 0x0000000000200da0 0x000260 0x000260 R   0x1

 Section to Segment mapping:
  Segment Sections...
   00     
   01     .interp 
   02     .interp .note.ABI-tag .note.gnu.build-id .hash .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame 
   03     .ctors .dtors .jcr .dynamic .got .data .bss 
   04     .dynamic 
   05     .note.ABI-tag .note.gnu.build-id 
   06     .eh_frame_hdr 
   07     
   08     .ctors .dtors .jcr .dynamic .got 

Dynamic section at offset 0xdc8 contains 24 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x730
 0x000000000000000d (FINI)               0xa98
 0x0000000000000004 (HASH)               0x298
 0x000000006ffffef5 (GNU_HASH)           0x2f0
 0x0000000000000005 (STRTAB)             0x4b0
 0x0000000000000006 (SYMTAB)             0x330
 0x000000000000000a (STRSZ)              227 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000015 (DEBUG)              0x0
 0x0000000000000003 (PLTGOT)             0x200f88
 0x0000000000000002 (PLTRELSZ)           120 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x6b8
 0x0000000000000007 (RELA)               0x5f8
 0x0000000000000008 (RELASZ)             192 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x0000000000000018 (BIND_NOW)           
 0x000000006ffffffb (FLAGS_1)            Flags: NOW
 0x000000006ffffffe (VERNEED)            0x5b8
 0x000000006fffffff (VERNEEDNUM)         1
 0x000000006ffffff0 (VERSYM)             0x594
 0x000000006ffffff9 (RELACOUNT)          5
 0x0000000000000000 (NULL)               0x0

Relocation section '.rela.dyn' at offset 0x5f8 contains 8 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200fc8  0000000000000008 R_X86_64_RELATIVE                               00000000000009c0
0000000000200fd8  0000000000000008 R_X86_64_RELATIVE                               00000000000008b0
0000000000200fe0  0000000000000008 R_X86_64_RELATIVE                               00000000000009d0
0000000000200fe8  0000000000000008 R_X86_64_RELATIVE                               0000000000000930
0000000000201008  0000000000000008 R_X86_64_RELATIVE                               0000000000201008
0000000000200fd0  0000000500000006 R_X86_64_GLOB_DAT      0000000000000000 __gmon_start__ + 0
0000000000200ff0  0000000700000006 R_X86_64_GLOB_DAT      0000000000000000 _Jv_RegisterClasses + 0
0000000000200ff8  0000000800000006 R_X86_64_GLOB_DAT      0000000000000000 __cxa_finalize + 0

Relocation section '.rela.plt' at offset 0x6b8 contains 5 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200fa0  0000000200000007 R_X86_64_JUMP_SLOT     0000000000000000 __snprintf_chk + 0
0000000000200fa8  0000000300000007 R_X86_64_JUMP_SLOT     0000000000000000 __stack_chk_fail + 0
0000000000200fb0  0000000400000007 R_X86_64_JUMP_SLOT     0000000000000000 __libc_start_main + 0
0000000000200fb8  0000000600000007 R_X86_64_JUMP_SLOT     0000000000000000 __printf_chk + 0
0000000000200fc0  0000000800000007 R_X86_64_JUMP_SLOT     0000000000000000 __cxa_finalize + 0

Symbol table '.dynsym' contains 16 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000238     0 SECTION LOCAL  DEFAULT    1 
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@GLIBC_2.3.4 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@GLIBC_2.4 (3)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (4)
     5: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@GLIBC_2.3.4 (2)
     7: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
     8: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (4)
     9: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    10: 00000000000008b0   126 FUNC    GLOBAL DEFAULT   14 announcement
    11: 0000000000201020     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    12: 00000000000009d0   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    13: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    14: 0000000000000930   134 FUNC    GLOBAL DEFAULT   14 main
    15: 00000000000009c0     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini

Symbol table '.symtab' contains 75 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000238     0 SECTION LOCAL  DEFAULT    1 
     2: 0000000000000254     0 SECTION LOCAL  DEFAULT    2 
     3: 0000000000000274     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000000298     0 SECTION LOCAL  DEFAULT    4 
     5: 00000000000002f0     0 SECTION LOCAL  DEFAULT    5 
     6: 0000000000000330     0 SECTION LOCAL  DEFAULT    6 
     7: 00000000000004b0     0 SECTION LOCAL  DEFAULT    7 
     8: 0000000000000594     0 SECTION LOCAL  DEFAULT    8 
     9: 00000000000005b8     0 SECTION LOCAL  DEFAULT    9 
    10: 00000000000005f8     0 SECTION LOCAL  DEFAULT   10 
    11: 00000000000006b8     0 SECTION LOCAL  DEFAULT   11 
    12: 0000000000000730     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000000750     0 SECTION LOCAL  DEFAULT   13 
    14: 00000000000007b0     0 SECTION LOCAL  DEFAULT   14 
    15: 0000000000000a98     0 SECTION LOCAL  DEFAULT   15 
    16: 0000000000000aa8     0 SECTION LOCAL  DEFAULT   16 
    17: 0000000000000abc     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000000af0     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000200da0     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000200db0     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000200dc0     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000200dc8     0 SECTION LOCAL  DEFAULT   22 
    23: 0000000000200f88     0 SECTION LOCAL  DEFAULT   23 
    24: 0000000000201000     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000201010     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000000000     0 SECTION LOCAL  DEFAULT   26 
    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 
    28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28 
    29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29 
    30: 0000000000000000     0 SECTION LOCAL  DEFAULT   30 
    31: 0000000000000000     0 SECTION LOCAL  DEFAULT   31 
    32: 0000000000000000     0 SECTION LOCAL  DEFAULT   32 
    33: 0000000000000000     0 SECTION LOCAL  DEFAULT   33 
    34: 00000000000007dc     0 FUNC    LOCAL  DEFAULT   14 call_gmon_start
    35: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    36: 0000000000200da0     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_LIST__
    37: 0000000000200db0     0 OBJECT  LOCAL  DEFAULT   20 __DTOR_LIST__
    38: 0000000000200dc0     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__
    39: 0000000000000800     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    40: 0000000000201010     1 OBJECT  LOCAL  DEFAULT   25 completed.5854
    41: 0000000000201018     8 OBJECT  LOCAL  DEFAULT   25 dtor_idx.5856
    42: 0000000000000880     0 FUNC    LOCAL  DEFAULT   14 frame_dummy
    43: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    44: 0000000000200da8     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_END__
    45: 0000000000000bc0     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__
    46: 0000000000200dc0     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__
    47: 0000000000000a60     0 FUNC    LOCAL  DEFAULT   14 __do_global_ctors_aux
    48: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
    49: 0000000000200d9c     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end
    50: 0000000000200dc8     0 OBJECT  LOCAL  DEFAULT  ABS _DYNAMIC
    51: 0000000000200d9c     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start
    52: 0000000000200f88     0 OBJECT  LOCAL  DEFAULT  ABS _GLOBAL_OFFSET_TABLE_
    53: 00000000000009c0     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini
    54: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@@GLIBC_2.3.4
    55: 0000000000201000     0 NOTYPE  WEAK   DEFAULT   24 data_start
    56: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    57: 0000000000000a98     0 FUNC    GLOBAL DEFAULT   15 _fini
    58: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@@GLIBC_2.4
    59: 0000000000200db8     0 OBJECT  GLOBAL HIDDEN    20 __DTOR_END__
    60: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_2.2.5
    61: 0000000000201000     0 NOTYPE  GLOBAL DEFAULT   24 __data_start
    62: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    63: 0000000000201008     0 OBJECT  GLOBAL HIDDEN    24 __dso_handle
    64: 00000000000008b0   126 FUNC    GLOBAL DEFAULT   14 announcement
    65: 0000000000000aa8     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
    66: 00000000000009d0   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    67: 0000000000201020     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    68: 00000000000007b0     0 FUNC    GLOBAL DEFAULT   14 _start
    69: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    70: 0000000000000930   134 FUNC    GLOBAL DEFAULT   14 main
    71: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@@GLIBC_2.3.4
    72: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    73: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2.5
    74: 0000000000000730     0 FUNC    GLOBAL DEFAULT   12 _init
# Run twice to show off PIE, if available in kernel
../build-tree/wrapper-test-linked
../build-tree/wrapper-test-linked: ok (0x2b53d15818b0)
../build-tree/wrapper-test-linked
../build-tree/wrapper-test-linked: ok (0x2ac1829188b0)
# Check state of hardening features via check script
sh ../hardening-check  ../build-tree/wrapper-test-linked
../build-tree/wrapper-test-linked:
 Position Independent Executable: yes
 Stack protected: yes
 Fortify Source functions: yes
 Read-only relocations: yes
 Immediate binding: yes
# Manually check state of hardening features
# Test PIE
readelf -lW ../build-tree/wrapper-test-linked | grep '^Elf file type is DYN'
Elf file type is DYN (Shared object file)
# Test Stack Protector
nm ../build-tree/wrapper-test-linked | egrep '__stack_chk_fail($|@@GLIBC)'
                 U __stack_chk_fail@@GLIBC_2.4
# Test Fortify
nm ../build-tree/wrapper-test-linked | egrep '__(sn)?printf_chk($|@@GLIBC)'
                 U __printf_chk@@GLIBC_2.3.4
                 U __snprintf_chk@@GLIBC_2.3.4
# Test Format (no-op currently)
# Test for RELRO
readelf -lW ../build-tree/wrapper-test-linked | grep GNU_RELRO
  GNU_RELRO      0x000da0 0x0000000000200da0 0x0000000000200da0 0x000260 0x000260 R   0x1
# Test for BIND_NOW
readelf -dW ../build-tree/wrapper-test-linked | grep BIND_NOW
 0x0000000000000018 (BIND_NOW)           
# Build directly with -fPIC already defined
../build-tree/hardened-cc -B ../build-tree/ -fPIC -g -O2 -O2  -o ../build-tree/wrapper-test-fPIC-direct hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -fPIC -g -O2 -O2 -o ../build-tree/wrapper-test-fPIC-direct hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-fPIC-direct /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu /tmp/cc-NelHbQ.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
../build-tree/wrapper-test-fPIC-direct
../build-tree/wrapper-test-fPIC-direct: ok (0x2af0f1fbf8b0)
# Build .o with -fPIC already defined
../build-tree/hardened-cc -B ../build-tree/ -fPIC -g -O2 -O2  -o ../build-tree/wrapper-test-fPIC.o -c hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -fPIC -g -O2 -O2 -o ../build-tree/wrapper-test-fPIC.o -c hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
# Link .o with -fPIC already defined
../build-tree/hardened-cc -B ../build-tree/ -fPIC -g -O2 -O2  -o ../build-tree/wrapper-test-fPIC ../build-tree/wrapper-test-fPIC.o
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -fPIC -g -O2 -O2 -o ../build-tree/wrapper-test-fPIC ../build-tree/wrapper-test-fPIC.o
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-fPIC /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu ../build-tree/wrapper-test-fPIC.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
../build-tree/wrapper-test-fPIC
../build-tree/wrapper-test-fPIC: ok (0x2ae46101f8b0)
# Make sure build fails due to -Werror=format-security
! ../build-tree/hardened-cc -B ../build-tree/ -g -O2 -O2  -o ../build-tree/wrapper-test-format-security format.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -fPIE -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -g -O2 -O2 -o ../build-tree/wrapper-test-format-security format.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-format-security /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu /tmp/cc-jEJYxa.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
make[2]: *** [../build-tree/wrapper-test-format-security] Error 1
make[1]: make[2]: Leaving directory `/build/hardening-wrapper-R3AL0s/hardening-wrapper-1.34/tests'
*** [check] Error 2
make: *** [test-stamp] Error 2
make[1]: Leaving directory `/build/hardening-wrapper-R3AL0s/hardening-wrapper-1.34/tests'
dpkg-buildpackage: error: debian/rules build gave error exit status 2
────────────────────────────────────────────────────────────────────────────────
Build finished at 20110911-1624

Finished
────────

E: Build failure (dpkg-buildpackage died)

┌──────────────────────────────────────────────────────────────────────────────┐
│ Cleanup                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘

Purging /var/lib/schroot/mount/lsid64c-8d2cf2f5-0d98-4842-83d5-984c6405c34e/build/hardening-wrapper-R3AL0s
Not cleaning session: cloned chroot in use

┌──────────────────────────────────────────────────────────────────────────────┐
│ Summary                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘

Architecture: amd64
Build-Space: 256
Build-Time: 5
Distribution: lsid64c
Fail-Stage: build
Install-Time: 10
Job: hardening-wrapper_1.34
Package: hardening-wrapper
Package-Time: 31
Source-Version: 1.34
Space: 256
Status: attempted
Version: 1.34
────────────────────────────────────────────────────────────────────────────────
Finished at 20110911-1624
Build needed 00:00:31, 256k disc space
DC-Message: Failed, but took only 35.540216. Retrying, you never know.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
Requested exclusive mode, but other builds running.
sbuild (Debian sbuild) 0.62.2 (05 Apr 2011) on talc-110.nancy.grid5000.fr

╔══════════════════════════════════════════════════════════════════════════════╗
║ hardening-wrapper 1.34 (amd64)                             11 Sep 2011 16:34 ║
╚══════════════════════════════════════════════════════════════════════════════╝

Package: hardening-wrapper
Version: 1.34
Source Version: 1.34
Distribution: lsid64c
Architecture: amd64


┌──────────────────────────────────────────────────────────────────────────────┐
│ Update chroot                                                                │
└──────────────────────────────────────────────────────────────────────────────┘

Ign http://localhost sid InRelease
Hit http://localhost sid Release.gpg
Hit http://localhost sid Release
Ign http://localhost sid/main Sources/DiffIndex
Ign http://localhost sid/main amd64 Packages/DiffIndex
Ign http://localhost sid/main TranslationIndex
Hit http://localhost sid/main Sources
Hit http://localhost sid/main amd64 Packages
Ign http://localhost sid/main Translation-en
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following packages will be upgraded:
  binutils cpp-4.6 g++-4.6 gcc-4.6 gcc-4.6-base libc-bin libc-dev-bin libc6
  libc6-dev libgcc1 libgomp1 libquadmath0 libstdc++6 libstdc++6-4.6-dev
  multiarch-support
15 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 34.4 MB of archives.
After this operation, 1073 kB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libc6-dev libc-dev-bin libgomp1 gcc-4.6-base libgcc1 cpp-4.6 libquadmath0
  libstdc++6-4.6-dev g++-4.6 gcc-4.6 libstdc++6 binutils libc-bin libc6
  multiarch-support
Authentication warning overridden.
Get:1 http://localhost/debian/ sid/main libc6-dev amd64 2.13-20 [2637 kB]
Get:2 http://localhost/debian/ sid/main libc-dev-bin amd64 2.13-20 [217 kB]
Get:3 http://localhost/debian/ sid/main libgomp1 amd64 4.6.1-10 [25.7 kB]
Get:4 http://localhost/debian/ sid/main gcc-4.6-base amd64 4.6.1-10 [135 kB]
Get:5 http://localhost/debian/ sid/main libgcc1 amd64 1:4.6.1-10 [42.9 kB]
Get:6 http://localhost/debian/ sid/main cpp-4.6 amd64 4.6.1-10 [4816 kB]
Get:7 http://localhost/debian/ sid/main libquadmath0 amd64 4.6.1-10 [126 kB]
Get:8 http://localhost/debian/ sid/main libstdc++6-4.6-dev amd64 4.6.1-10 [1660 kB]
Get:9 http://localhost/debian/ sid/main g++-4.6 amd64 4.6.1-10 [6952 kB]
Get:10 http://localhost/debian/ sid/main gcc-4.6 amd64 4.6.1-10 [7303 kB]
Get:11 http://localhost/debian/ sid/main libstdc++6 amd64 4.6.1-10 [337 kB]
Get:12 http://localhost/debian/ sid/main binutils amd64 2.21.53.20110910-1 [4844 kB]
Get:13 http://localhost/debian/ sid/main libc-bin amd64 2.13-20 [819 kB]
Get:14 http://localhost/debian/ sid/main libc6 amd64 2.13-20 [4323 kB]
Get:15 http://localhost/debian/ sid/main multiarch-support amd64 2.13-20 [141 kB]
Preconfiguring packages ...
Fetched 34.4 MB in 0s (54.7 MB/s)
(Reading database ... 10788 files and directories currently installed.)
Preparing to replace libc6-dev 2.13-18 (using .../libc6-dev_2.13-20_amd64.deb) ...
Unpacking replacement libc6-dev ...
Preparing to replace libc-dev-bin 2.13-18 (using .../libc-dev-bin_2.13-20_amd64.deb) ...
Unpacking replacement libc-dev-bin ...
Preparing to replace libgomp1 4.6.1-9 (using .../libgomp1_4.6.1-10_amd64.deb) ...
Unpacking replacement libgomp1 ...
Preparing to replace gcc-4.6-base 4.6.1-9 (using .../gcc-4.6-base_4.6.1-10_amd64.deb) ...
Unpacking replacement gcc-4.6-base ...
Setting up gcc-4.6-base (4.6.1-10) ...
(Reading database ... 10788 files and directories currently installed.)
Preparing to replace libgcc1 1:4.6.1-9 (using .../libgcc1_1%3a4.6.1-10_amd64.deb) ...
Unpacking replacement libgcc1 ...
Setting up libgcc1 (1:4.6.1-10) ...
(Reading database ... 10788 files and directories currently installed.)
Preparing to replace cpp-4.6 4.6.1-9 (using .../cpp-4.6_4.6.1-10_amd64.deb) ...
Unpacking replacement cpp-4.6 ...
Preparing to replace libquadmath0 4.6.1-9 (using .../libquadmath0_4.6.1-10_amd64.deb) ...
Unpacking replacement libquadmath0 ...
Preparing to replace libstdc++6-4.6-dev 4.6.1-9 (using .../libstdc++6-4.6-dev_4.6.1-10_amd64.deb) ...
Unpacking replacement libstdc++6-4.6-dev ...
Preparing to replace g++-4.6 4.6.1-9 (using .../g++-4.6_4.6.1-10_amd64.deb) ...
Unpacking replacement g++-4.6 ...
Preparing to replace gcc-4.6 4.6.1-9 (using .../gcc-4.6_4.6.1-10_amd64.deb) ...
Unpacking replacement gcc-4.6 ...
Preparing to replace libstdc++6 4.6.1-9 (using .../libstdc++6_4.6.1-10_amd64.deb) ...
Unpacking replacement libstdc++6 ...
Setting up libstdc++6 (4.6.1-10) ...
(Reading database ... 10801 files and directories currently installed.)
Preparing to replace binutils 2.21.53.20110823-3 (using .../binutils_2.21.53.20110910-1_amd64.deb) ...
Unpacking replacement binutils ...
Preparing to replace libc-bin 2.13-18 (using .../libc-bin_2.13-20_amd64.deb) ...
Unpacking replacement libc-bin ...
Setting up libc-bin (2.13-20) ...
(Reading database ... 10801 files and directories currently installed.)
Preparing to replace libc6 2.13-18 (using .../libc6_2.13-20_amd64.deb) ...
Unpacking replacement libc6 ...
Setting up libc6 (2.13-20) ...
(Reading database ... 10801 files and directories currently installed.)
Preparing to replace multiarch-support 2.13-18 (using .../multiarch-support_2.13-20_amd64.deb) ...
Unpacking replacement multiarch-support ...
Setting up multiarch-support (2.13-20) ...
Setting up libc-dev-bin (2.13-20) ...
Setting up libc6-dev (2.13-20) ...
Setting up libgomp1 (4.6.1-10) ...
Setting up cpp-4.6 (4.6.1-10) ...
Setting up libquadmath0 (4.6.1-10) ...
Setting up binutils (2.21.53.20110910-1) ...
Setting up gcc-4.6 (4.6.1-10) ...
Setting up libstdc++6-4.6-dev (4.6.1-10) ...
Setting up g++-4.6 (4.6.1-10) ...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Fetch source files                                                           │
└──────────────────────────────────────────────────────────────────────────────┘


Check APT
─────────

Checking available source versions...

Download source files with APT
──────────────────────────────

Reading package lists...
Building dependency tree...
Reading state information...
NOTICE: 'hardening-wrapper' packaging is maintained in the 'Bzr' version control system at:
http://anonscm.debian.org/bzr/hardening/master
Please use:
bzr get http://anonscm.debian.org/bzr/hardening/master
to retrieve the latest (possibly unreleased) updates to the package.
Need to get 18.4 kB of source archives.
Get:1 http://localhost/debian/ sid/main hardening-wrapper 1.34 (dsc) [1724 B]
Get:2 http://localhost/debian/ sid/main hardening-wrapper 1.34 (tar) [16.6 kB]
Fetched 18.4 kB in 0s (0 B/s)
Download complete and in download only mode

Check arch
──────────

Merged Build-Depends: build-essential, fakeroot
Filtered Build-Depends: build-essential, fakeroot
dpkg-deb: building package `sbuild-build-depends-core-dummy' in `/build/hardening-wrapper-0Xyekl/resolver-M6gkpE/apt_archive/sbuild-build-depends-core-dummy.deb'.
OK
Reading package lists...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Install core build dependencies (apt-based resolver)                         │
└──────────────────────────────────────────────────────────────────────────────┘

Installing build dependencies
Reading package lists...
Building dependency tree...
Reading state information...
The following NEW packages will be installed:
  sbuild-build-depends-core-dummy
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B/702 B of archives.
After this operation, 0 B of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  sbuild-build-depends-core-dummy
Authentication warning overridden.
Selecting previously deselected package sbuild-build-depends-core-dummy.
(Reading database ... 10801 files and directories currently installed.)
Unpacking sbuild-build-depends-core-dummy (from .../sbuild-build-depends-core-dummy.deb) ...
Setting up sbuild-build-depends-core-dummy (0.invalid.0) ...
Cannot open /var/lib/schroot/mount/lsid64c-8b992ee0-5c8b-40cb-9b0e-0916ce084843/etc/lsb-release: No such file or directory
Merged Build-Depends: base-files, base-passwd, bash, coreutils, dash, debianutils, diffutils, dpkg, e2fsprogs, findutils, grep, gzip, hostname, ncurses-base, ncurses-bin, perl-base, sed, login, sysvinit-utils, sysvinit, tar, bsdutils, mount, util-linux, libc6-dev | libc-dev, gcc (>= 4:4.4.3), g++ (>= 4:4.4.3), make, dpkg-dev (>= 1.13.5), debhelper (>= 7)
Filtered Build-Depends: base-files, base-passwd, bash, coreutils, dash, debianutils, diffutils, dpkg, e2fsprogs, findutils, grep, gzip, hostname, ncurses-base, ncurses-bin, perl-base, sed, login, sysvinit-utils, sysvinit, tar, bsdutils, mount, util-linux, libc6-dev, gcc (>= 4:4.4.3), g++ (>= 4:4.4.3), make, dpkg-dev (>= 1.13.5), debhelper (>= 7)
dpkg-deb: building package `sbuild-build-depends-hardening-wrapper-dummy' in `/build/hardening-wrapper-0Xyekl/resolver-VqHrCw/apt_archive/sbuild-build-depends-hardening-wrapper-dummy.deb'.
OK
Reading package lists...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Install hardening-wrapper build dependencies (apt-based resolver)            │
└──────────────────────────────────────────────────────────────────────────────┘

Installing build dependencies
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  bsdmainutils debhelper file gettext gettext-base groff-base html2text
  intltool-debian libcroco3 libglib2.0-0 libmagic1 libpcre3 libpipeline1
  libunistring0 libxml2 man-db po-debconf
Suggested packages:
  wamerican wordlist whois vacation dh-make gettext-doc groff www-browser
  libmail-box-perl
Recommended packages:
  curl wget lynx-cur autopoint libglib2.0-data shared-mime-info xml-core
  libmail-sendmail-perl
The following NEW packages will be installed:
  bsdmainutils debhelper file gettext gettext-base groff-base html2text
  intltool-debian libcroco3 libglib2.0-0 libmagic1 libpcre3 libpipeline1
  libunistring0 libxml2 man-db po-debconf
  sbuild-build-depends-hardening-wrapper-dummy
0 upgraded, 18 newly installed, 0 to remove and 0 not upgraded.
Need to get 9196 kB/9197 kB of archives.
After this operation, 27.3 MB of additional disk space will be used.
WARNING: The following packages cannot be authenticated!
  libpipeline1 libpcre3 bsdmainutils groff-base man-db libmagic1 file
  gettext-base libxml2 html2text libglib2.0-0 libcroco3 libunistring0 gettext
  intltool-debian po-debconf debhelper
  sbuild-build-depends-hardening-wrapper-dummy
Authentication warning overridden.
Get:1 http://localhost/debian/ sid/main libpipeline1 amd64 1.2.0-3 [37.9 kB]
Get:2 http://localhost/debian/ sid/main libpcre3 amd64 8.12-4 [225 kB]
Get:3 http://localhost/debian/ sid/main bsdmainutils amd64 8.2.3 [208 kB]
Get:4 http://localhost/debian/ sid/main groff-base amd64 1.21-6 [1150 kB]
Get:5 http://localhost/debian/ sid/main man-db amd64 2.6.0.2-2 [1023 kB]
Get:6 http://localhost/debian/ sid/main libmagic1 amd64 5.08-1 [246 kB]
Get:7 http://localhost/debian/ sid/main file amd64 5.08-1 [51.7 kB]
Get:8 http://localhost/debian/ sid/main gettext-base amd64 0.18.1.1-4 [154 kB]
Get:9 http://localhost/debian/ sid/main libxml2 amd64 2.7.8.dfsg-4 [892 kB]
Get:10 http://localhost/debian/ sid/main html2text amd64 1.3.2a-15 [103 kB]
Get:11 http://localhost/debian/ sid/main libglib2.0-0 amd64 2.28.6-1 [1648 kB]
Get:12 http://localhost/debian/ sid/main libcroco3 amd64 0.6.2-1 [125 kB]
Get:13 http://localhost/debian/ sid/main libunistring0 amd64 0.9.3-4 [437 kB]
Get:14 http://localhost/debian/ sid/main gettext amd64 0.18.1.1-4 [2079 kB]
Get:15 http://localhost/debian/ sid/main intltool-debian all 0.35.0+20060710.1 [30.8 kB]
Get:16 http://localhost/debian/ sid/main po-debconf all 1.0.16+nmu1 [223 kB]
Get:17 http://localhost/debian/ sid/main debhelper all 8.9.6 [562 kB]
Preconfiguring packages ...
Fetched 9196 kB in 0s (50.5 MB/s)
Selecting previously deselected package libpipeline1.
(Reading database ... 10801 files and directories currently installed.)
Unpacking libpipeline1 (from .../libpipeline1_1.2.0-3_amd64.deb) ...
Selecting previously deselected package libpcre3.
Unpacking libpcre3 (from .../libpcre3_8.12-4_amd64.deb) ...
Selecting previously deselected package bsdmainutils.
Unpacking bsdmainutils (from .../bsdmainutils_8.2.3_amd64.deb) ...
Selecting previously deselected package groff-base.
Unpacking groff-base (from .../groff-base_1.21-6_amd64.deb) ...
Selecting previously deselected package man-db.
Unpacking man-db (from .../man-db_2.6.0.2-2_amd64.deb) ...
Selecting previously deselected package libmagic1.
Unpacking libmagic1 (from .../libmagic1_5.08-1_amd64.deb) ...
Selecting previously deselected package file.
Unpacking file (from .../archives/file_5.08-1_amd64.deb) ...
Selecting previously deselected package gettext-base.
Unpacking gettext-base (from .../gettext-base_0.18.1.1-4_amd64.deb) ...
Selecting previously deselected package libxml2.
Unpacking libxml2 (from .../libxml2_2.7.8.dfsg-4_amd64.deb) ...
Selecting previously deselected package html2text.
Unpacking html2text (from .../html2text_1.3.2a-15_amd64.deb) ...
Selecting previously deselected package libglib2.0-0.
Unpacking libglib2.0-0 (from .../libglib2.0-0_2.28.6-1_amd64.deb) ...
Selecting previously deselected package libcroco3.
Unpacking libcroco3 (from .../libcroco3_0.6.2-1_amd64.deb) ...
Selecting previously deselected package libunistring0.
Unpacking libunistring0 (from .../libunistring0_0.9.3-4_amd64.deb) ...
Selecting previously deselected package gettext.
Unpacking gettext (from .../gettext_0.18.1.1-4_amd64.deb) ...
Selecting previously deselected package intltool-debian.
Unpacking intltool-debian (from .../intltool-debian_0.35.0+20060710.1_all.deb) ...
Selecting previously deselected package po-debconf.
Unpacking po-debconf (from .../po-debconf_1.0.16+nmu1_all.deb) ...
Selecting previously deselected package debhelper.
Unpacking debhelper (from .../debhelper_8.9.6_all.deb) ...
Selecting previously deselected package sbuild-build-depends-hardening-wrapper-dummy.
Unpacking sbuild-build-depends-hardening-wrapper-dummy (from .../sbuild-build-depends-hardening-wrapper-dummy.deb) ...
Processing triggers for install-info ...
Setting up libpipeline1 (1.2.0-3) ...
Setting up libpcre3 (8.12-4) ...
Setting up bsdmainutils (8.2.3) ...
update-alternatives: using /usr/bin/bsd-write to provide /usr/bin/write (write) in auto mode.
update-alternatives: using /usr/bin/bsd-from to provide /usr/bin/from (from) in auto mode.
Setting up groff-base (1.21-6) ...
Setting up man-db (2.6.0.2-2) ...
Building database of manual pages ...
Setting up libmagic1 (5.08-1) ...
Setting up file (5.08-1) ...
Setting up gettext-base (0.18.1.1-4) ...
Setting up libxml2 (2.7.8.dfsg-4) ...
Setting up html2text (1.3.2a-15) ...
Setting up libglib2.0-0 (2.28.6-1) ...
No schema files found: doing nothing.
Setting up libcroco3 (0.6.2-1) ...
Setting up libunistring0 (0.9.3-4) ...
Setting up gettext (0.18.1.1-4) ...
Setting up intltool-debian (0.35.0+20060710.1) ...
Setting up po-debconf (1.0.16+nmu1) ...
Setting up debhelper (8.9.6) ...
Setting up sbuild-build-depends-hardening-wrapper-dummy (0.invalid.0) ...

┌──────────────────────────────────────────────────────────────────────────────┐
│ Build environment                                                            │
└──────────────────────────────────────────────────────────────────────────────┘

Kernel: Linux 2.6.32-5-amd64 amd64 (x86_64)
Toolchain package versions: binutils_2.21.53.20110910-1 dpkg-dev_1.16.0.3 g++-4.6_4.6.1-10 gcc-4.6_4.6.1-10 libc6-dev_2.13-20 libstdc++6_4.6.1-10 libstdc++6-4.6-dev_4.6.1-10 linux-libc-dev_3.0.0-3
Package versions: apt_0.8.15.6 apt-utils_0.8.15.6 base-files_6.5 base-passwd_3.5.23 bash_4.1-3 binutils_2.21.53.20110910-1 bsdmainutils_8.2.3 bsdutils_1:2.19.1-5 build-essential_11.5 bzip2_1.0.5-7 clang_2.9-11 coreutils_8.5-1 cpp_4:4.6.1-2 cpp-4.6_4.6.1-10 dash_0.5.7-1 debconf_1.5.41 debfoster_2.7-1.1 debhelper_8.9.6 debian-archive-keyring_2010.08.28 debianutils_4.0.2 diffutils_1:3.0-1 dpkg_1.16.0.3 dpkg-dev_1.16.0.3 e2fslibs_1.42~WIP-2011-07-02-1 e2fsprogs_1.42~WIP-2011-07-02-1 fakeroot_1.18-1 file_5.08-1 findutils_4.4.2-1+b1 g++_4:4.6.1-2 g++-4.6_4.6.1-10 gcc_4:4.6.1-2 gcc-4.6_4.6.1-10 gcc-4.6-base_4.6.1-10 gettext_0.18.1.1-4 gettext-base_0.18.1.1-4 gnupg_1.4.11-3 gpgv_1.4.11-3 grep_2.9-2 groff-base_1.21-6 gzip_1.4-1 hostname_3.06 html2text_1.3.2a-15 initscripts_2.88dsf-13.11 insserv_1.14.0-2.1 install-info_4.13a.dfsg.1-8 intltool-debian_0.35.0+20060710.1 less_444-1 libacl1_2.2.51-3 libattr1_1:2.4.46-3 libblkid1_2.19.1-5 libbz2-1.0_1.0.5-7 libc-bin_2.13-20 libc-dev-bin_2.13-20 libc6_2.13-20 libc6-dev_2.13-20 libcomerr2_1.42~WIP-2011-07-02-1 libcroco3_0.6.2-1 libdb5.1_5.1.25-11 libdpkg-perl_1.16.0.3 libffi5_3.0.10~rc10-3 libgc1c2_1:7.1-8 libgcc1_1:4.6.1-10 libgdbm3_1.8.3-10 libglib2.0-0_2.28.6-1 libgmp10_2:5.0.2+dfsg-1 libgomp1_4.6.1-10 libllvm2.9_2.9+dfsg-3 liblzma2_5.1.1alpha+20110809-2 libmagic1_5.08-1 libmount1_2.19.1-5 libmpc2_0.9-3 libmpfr4_3.0.1-6 libncurses5_5.9-1 libncursesw5_5.9-1 libpam-modules_1.1.3-2 libpam-modules-bin_1.1.3-2 libpam-runtime_1.1.3-2 libpam0g_1.1.3-2 libpcre3_8.12-4 libpipeline1_1.2.0-3 libquadmath0_4.6.1-10 libreadline6_6.2-4 libselinux1_2.1.0-1 libsepol1_2.1.0-1.1 libslang2_2.2.4-3 libss2_1.42~WIP-2011-07-02-1 libstdc++6_4.6.1-10 libstdc++6-4.6-dev_4.6.1-10 libtimedate-perl_1.2000-1 libunistring0_0.9.3-4 libusb-0.1-4_2:0.1.12-19 libuuid1_2.19.1-5 libxml2_2.7.8.dfsg-4 linux-libc-dev_3.0.0-3 login_1:4.1.4.2+svn3283-3 lsb-base_3.2-28 make_3.81-8.1 man-db_2.6.0.2-2 mawk_1.3.3-15 mount_2.19.1-5 multiarch-support_2.13-20 ncurses-base_5.9-1 ncurses-bin_5.9-1 nvi_1.81.6-8.2 passwd_1:4.1.4.2+svn3283-3 patch_2.6.1-2 perl_5.12.4-4 perl-base_5.12.4-4 perl-modules_5.12.4-4 po-debconf_1.0.16+nmu1 readline-common_6.2-4 sbuild-build-depends-core-dummy_0.invalid.0 sbuild-build-depends-hardening-wrapper-dummy_0.invalid.0 sed_4.2.1-9 sensible-utils_0.0.6 sysv-rc_2.88dsf-13.11 sysvinit_2.88dsf-13.11 sysvinit-utils_2.88dsf-13.11 tar_1.26-2 tzdata_2011i-2 util-linux_2.19.1-5 xz-utils_5.1.1alpha+20110809-2 zlib1g_1:1.2.3.4.dfsg-3

┌──────────────────────────────────────────────────────────────────────────────┐
│ Build                                                                        │
└──────────────────────────────────────────────────────────────────────────────┘


Unpack source
─────────────

gpgv: keyblock resource `/var/lib/sbuild/.gnupg/trustedkeys.gpg': file open error
gpgv: Signature made Fri Jul 29 04:51:21 2011 CEST using RSA key ID DC6DC026
gpgv: Can't check signature: public key not found
dpkg-source: warning: failed to verify signature on ./hardening-wrapper_1.34.dsc
dpkg-source: info: extracting hardening-wrapper in hardening-wrapper-1.34
dpkg-source: info: unpacking hardening-wrapper_1.34.tar.gz

Check disc space
────────────────

Sufficient free space for build

dpkg-buildpackage
─────────────────

dpkg-buildpackage: export CFLAGS from dpkg-buildflags (origin: vendor): -g -O2
dpkg-buildpackage: export CPPFLAGS from dpkg-buildflags (origin: vendor): 
dpkg-buildpackage: export CXXFLAGS from dpkg-buildflags (origin: vendor): -g -O2
dpkg-buildpackage: export FFLAGS from dpkg-buildflags (origin: vendor): -g -O2
dpkg-buildpackage: export LDFLAGS from dpkg-buildflags (origin: vendor): 
dpkg-buildpackage: source package hardening-wrapper
dpkg-buildpackage: source version 1.34
 dpkg-source --before-build hardening-wrapper-1.34
dpkg-buildpackage: host architecture amd64
 fakeroot debian/rules clean
dh_testdir
dh_testroot
rm -f build-stamp test-stamp
rm -rf build-tree
rm -f hardened-c++.1 hardening-wrapper.1 hardening-check.1
dh_clean
 dpkg-source -b hardening-wrapper-1.34
dpkg-source: info: using source format `3.0 (native)'
dpkg-source: info: building hardening-wrapper in hardening-wrapper_1.34.tar.gz
dpkg-source: info: building hardening-wrapper in hardening-wrapper_1.34.dsc
 debian/rules build
# Building
dh_testdir
mkdir -p build-tree
install hardened-cc hardened-ld build-tree
# Set defaults, based on OS and ARCH
perl -pi -e 's/ #OS#/ '"linux"'/; s/ #ARCH#/ '"amd64"'/;' build-tree/hardened-cc build-tree/hardened-ld
perl -pi -e "s/default{'DEB_BUILD_HARDENING_PIE'}=1;/default{'DEB_BUILD_HARDENING_PIE'}=1;/;" build-tree/hardened-cc build-tree/hardened-ld
perl -pi -e "s/default{'DEB_BUILD_HARDENING_STACKPROTECTOR'}=1;/default{'DEB_BUILD_HARDENING_STACKPROTECTOR'}=1;/;" build-tree/hardened-cc build-tree/hardened-ld
# Duplicate cc wrapper to c++
cp build-tree/hardened-cc build-tree/hardened-c++
perl -pi -e 's/hardened-cc/hardened-c++/g; s|/usr/bin/cc|/usr/bin/c++|g;' build-tree/hardened-c++
# Set up man pages
ln -sf hardened-cc.1 hardening-wrapper.1
cp hardened-cc.1 hardened-c++.1
perl -pi -e 's/hardened-cc/hardened-c++/g; s/gcc/g++/g;' hardened-c++.1
pod2man hardening-check > hardening-check.1
# Done building
touch build-stamp
(cd tests; make check)
make[1]: Entering directory `/build/hardening-wrapper-0Xyekl/hardening-wrapper-1.34/tests'
# Check the stack protector and PIE options directly, just to have
# a historical record in the build logs.
cc -Wall -fstack-protector hello.c -o ../build-tree/cc-test || true
../build-tree/cc-test || true
../build-tree/cc-test: ok (0x4005b0)
cc -Wall -fPIE -pie hello.c -o ../build-tree/cc-test || true
../build-tree/cc-test || true
../build-tree/cc-test: ok (0x2adc42ebb7d0)
../build-tree/cc-test || true
../build-tree/cc-test: ok (0x2b04be4db7d0)
make -f Makefile.wrapper check
make[2]: Entering directory `/build/hardening-wrapper-0Xyekl/hardening-wrapper-1.34/tests'
# Test basic perl syntax
for script in ../build-tree/hardened-cc ../build-tree/hardened-ld ../build-tree/hardened-c++; do perl -c $script; done
../build-tree/hardened-cc syntax OK
../build-tree/hardened-ld syntax OK
../build-tree/hardened-c++ syntax OK
touch syntax.stamp
# Compiler and linker options disabled.
DEB_BUILD_HARDENING=0 ../build-tree/hardened-cc -B ../build-tree/ -o ../build-tree/wrapper-test-stock hello.c
/usr/bin/clang -B ../build-tree/ -o ../build-tree/wrapper-test-stock hello.c
readelf -ldrsW ../build-tree/wrapper-test-stock

Elf file type is EXEC (Executable file)
Entry point 0x400450
There are 8 program headers, starting at offset 64

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  PHDR           0x000040 0x0000000000400040 0x0000000000400040 0x0001c0 0x0001c0 R E 0x8
  INTERP         0x000200 0x0000000000400200 0x0000000000400200 0x00001c 0x00001c R   0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x000000 0x0000000000400000 0x0000000000400000 0x0007fc 0x0007fc R E 0x200000
  LOAD           0x000800 0x0000000000600800 0x0000000000600800 0x000210 0x000220 RW  0x200000
  DYNAMIC        0x000828 0x0000000000600828 0x0000000000600828 0x0001a0 0x0001a0 RW  0x8
  NOTE           0x00021c 0x000000000040021c 0x000000000040021c 0x000044 0x000044 R   0x4
  GNU_EH_FRAME   0x0006dc 0x00000000004006dc 0x00000000004006dc 0x000034 0x000034 R   0x4
  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x8

 Section to Segment mapping:
  Segment Sections...
   00     
   01     .interp 
   02     .interp .note.ABI-tag .note.gnu.build-id .hash .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame 
   03     .ctors .dtors .jcr .dynamic .got .got.plt .data .bss 
   04     .dynamic 
   05     .note.ABI-tag .note.gnu.build-id 
   06     .eh_frame_hdr 
   07     

Dynamic section at offset 0x828 contains 21 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x4003f0
 0x000000000000000d (FINI)               0x4006b8
 0x0000000000000004 (HASH)               0x400260
 0x000000006ffffef5 (GNU_HASH)           0x400288
 0x0000000000000005 (STRTAB)             0x400320
 0x0000000000000006 (SYMTAB)             0x4002a8
 0x000000000000000a (STRSZ)              65 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000015 (DEBUG)              0x0
 0x0000000000000003 (PLTGOT)             0x6009d0
 0x0000000000000002 (PLTRELSZ)           72 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4003a8
 0x0000000000000007 (RELA)               0x400390
 0x0000000000000008 (RELASZ)             24 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x400370
 0x000000006fffffff (VERNEEDNUM)         1
 0x000000006ffffff0 (VERSYM)             0x400362
 0x0000000000000000 (NULL)               0x0

Relocation section '.rela.dyn' at offset 0x390 contains 1 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
00000000006009c8  0000000400000006 R_X86_64_GLOB_DAT      0000000000000000 __gmon_start__ + 0

Relocation section '.rela.plt' at offset 0x3a8 contains 3 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
00000000006009e8  0000000100000007 R_X86_64_JUMP_SLOT     0000000000000000 printf + 0
00000000006009f0  0000000200000007 R_X86_64_JUMP_SLOT     0000000000000000 snprintf + 0
00000000006009f8  0000000300000007 R_X86_64_JUMP_SLOT     0000000000000000 __libc_start_main + 0

Symbol table '.dynsym' contains 5 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.2.5 (2)
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND snprintf@GLIBC_2.2.5 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)
     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__

Symbol table '.symtab' contains 67 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000400200     0 SECTION LOCAL  DEFAULT    1 
     2: 000000000040021c     0 SECTION LOCAL  DEFAULT    2 
     3: 000000000040023c     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000400260     0 SECTION LOCAL  DEFAULT    4 
     5: 0000000000400288     0 SECTION LOCAL  DEFAULT    5 
     6: 00000000004002a8     0 SECTION LOCAL  DEFAULT    6 
     7: 0000000000400320     0 SECTION LOCAL  DEFAULT    7 
     8: 0000000000400362     0 SECTION LOCAL  DEFAULT    8 
     9: 0000000000400370     0 SECTION LOCAL  DEFAULT    9 
    10: 0000000000400390     0 SECTION LOCAL  DEFAULT   10 
    11: 00000000004003a8     0 SECTION LOCAL  DEFAULT   11 
    12: 00000000004003f0     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000400410     0 SECTION LOCAL  DEFAULT   13 
    14: 0000000000400450     0 SECTION LOCAL  DEFAULT   14 
    15: 00000000004006b8     0 SECTION LOCAL  DEFAULT   15 
    16: 00000000004006c8     0 SECTION LOCAL  DEFAULT   16 
    17: 00000000004006dc     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000400710     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000600800     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000600810     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000600820     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000600828     0 SECTION LOCAL  DEFAULT   22 
    23: 00000000006009c8     0 SECTION LOCAL  DEFAULT   23 
    24: 00000000006009d0     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000600a00     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000600a10     0 SECTION LOCAL  DEFAULT   26 
    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 
    28: 000000000040047c     0 FUNC    LOCAL  DEFAULT   14 call_gmon_start
    29: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    30: 0000000000600800     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_LIST__
    31: 0000000000600810     0 OBJECT  LOCAL  DEFAULT   20 __DTOR_LIST__
    32: 0000000000600820     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__
    33: 00000000004004a0     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    34: 0000000000600a10     1 OBJECT  LOCAL  DEFAULT   26 completed.5854
    35: 0000000000600a18     8 OBJECT  LOCAL  DEFAULT   26 dtor_idx.5856
    36: 0000000000400510     0 FUNC    LOCAL  DEFAULT   14 frame_dummy
    37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    38: 0000000000600808     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_END__
    39: 00000000004007f8     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__
    40: 0000000000600820     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__
    41: 0000000000400680     0 FUNC    LOCAL  DEFAULT   14 __do_global_ctors_aux
    42: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
    43: 00000000006007fc     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end
    44: 0000000000600828     0 OBJECT  LOCAL  DEFAULT   22 _DYNAMIC
    45: 00000000006007fc     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start
    46: 00000000006009d0     0 OBJECT  LOCAL  DEFAULT   24 _GLOBAL_OFFSET_TABLE_
    47: 00000000004005e0     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini
    48: 0000000000600a00     0 NOTYPE  WEAK   DEFAULT   25 data_start
    49: 0000000000600a10     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    50: 00000000004006b8     0 FUNC    GLOBAL DEFAULT   15 _fini
    51: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND printf@@GLIBC_2.2.5
    52: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND snprintf@@GLIBC_2.2.5
    53: 0000000000600818     0 OBJECT  GLOBAL HIDDEN    20 __DTOR_END__
    54: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_2.2.5
    55: 0000000000600a00     0 NOTYPE  GLOBAL DEFAULT   25 __data_start
    56: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    57: 0000000000600a08     0 OBJECT  GLOBAL HIDDEN    25 __dso_handle
    58: 0000000000400540    96 FUNC    GLOBAL DEFAULT   14 announcement
    59: 00000000004006c8     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
    60: 00000000004005f0   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    61: 0000000000600a20     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    62: 0000000000400450     0 FUNC    GLOBAL DEFAULT   14 _start
    63: 0000000000600a10     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    64: 00000000004005a0    57 FUNC    GLOBAL DEFAULT   14 main
    65: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    66: 00000000004003f0     0 FUNC    GLOBAL DEFAULT   12 _init
../build-tree/wrapper-test-stock
../build-tree/wrapper-test-stock: ok (0x400540)
# Compiler options enabled. (linker is not wrapper)
../build-tree/hardened-cc -B ../build-tree/ -g -O2 -O2  -o ../build-tree/wrapper-test-compiled hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -fPIE -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -g -O2 -O2 -o ../build-tree/wrapper-test-compiled hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
readelf -ldrsW ../build-tree/wrapper-test-compiled

Elf file type is DYN (Shared object file)
Entry point 0x770
There are 8 program headers, starting at offset 64

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  PHDR           0x000040 0x0000000000000040 0x0000000000000040 0x0001c0 0x0001c0 R E 0x8
  INTERP         0x000200 0x0000000000000200 0x0000000000000200 0x00001c 0x00001c R   0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x000b84 0x000b84 R E 0x200000
  LOAD           0x000b88 0x0000000000200b88 0x0000000000200b88 0x000250 0x000260 RW  0x200000
  DYNAMIC        0x000bb0 0x0000000000200bb0 0x0000000000200bb0 0x0001a0 0x0001a0 RW  0x8
  NOTE           0x00021c 0x000000000000021c 0x000000000000021c 0x000044 0x000044 R   0x4
  GNU_EH_FRAME   0x000a7c 0x0000000000000a7c 0x0000000000000a7c 0x000034 0x000034 R   0x4
  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x8

 Section to Segment mapping:
  Segment Sections...
   00     
   01     .interp 
   02     .interp .note.ABI-tag .note.gnu.build-id .hash .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame 
   03     .ctors .dtors .jcr .dynamic .got .got.plt .data .bss 
   04     .dynamic 
   05     .note.ABI-tag .note.gnu.build-id 
   06     .eh_frame_hdr 
   07     

Dynamic section at offset 0xbb0 contains 22 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x6f8
 0x000000000000000d (FINI)               0xa58
 0x0000000000000004 (HASH)               0x260
 0x000000006ffffef5 (GNU_HASH)           0x2b8
 0x0000000000000005 (STRTAB)             0x478
 0x0000000000000006 (SYMTAB)             0x2f8
 0x000000000000000a (STRSZ)              227 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000015 (DEBUG)              0x0
 0x0000000000000003 (PLTGOT)             0x200d88
 0x0000000000000002 (PLTRELSZ)           120 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x680
 0x0000000000000007 (RELA)               0x5c0
 0x0000000000000008 (RELASZ)             192 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x580
 0x000000006fffffff (VERNEEDNUM)         1
 0x000000006ffffff0 (VERSYM)             0x55c
 0x000000006ffffff9 (RELACOUNT)          5
 0x0000000000000000 (NULL)               0x0

Relocation section '.rela.dyn' at offset 0x5c0 contains 8 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200d50  0000000000000008 R_X86_64_RELATIVE                               0000000000000980
0000000000200d60  0000000000000008 R_X86_64_RELATIVE                               0000000000000870
0000000000200d68  0000000000000008 R_X86_64_RELATIVE                               0000000000000990
0000000000200d70  0000000000000008 R_X86_64_RELATIVE                               00000000000008f0
0000000000200dd0  0000000000000008 R_X86_64_RELATIVE                               0000000000200dd0
0000000000200d58  0000000500000006 R_X86_64_GLOB_DAT      0000000000000000 __gmon_start__ + 0
0000000000200d78  0000000700000006 R_X86_64_GLOB_DAT      0000000000000000 _Jv_RegisterClasses + 0
0000000000200d80  0000000800000006 R_X86_64_GLOB_DAT      0000000000000000 __cxa_finalize + 0

Relocation section '.rela.plt' at offset 0x680 contains 5 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200da0  0000000200000007 R_X86_64_JUMP_SLOT     0000000000000000 __snprintf_chk + 0
0000000000200da8  0000000300000007 R_X86_64_JUMP_SLOT     0000000000000000 __stack_chk_fail + 0
0000000000200db0  0000000400000007 R_X86_64_JUMP_SLOT     0000000000000000 __libc_start_main + 0
0000000000200db8  0000000600000007 R_X86_64_JUMP_SLOT     0000000000000000 __printf_chk + 0
0000000000200dc0  0000000800000007 R_X86_64_JUMP_SLOT     0000000000000000 __cxa_finalize + 0

Symbol table '.dynsym' contains 16 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000200     0 SECTION LOCAL  DEFAULT    1 
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@GLIBC_2.3.4 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@GLIBC_2.4 (3)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (4)
     5: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@GLIBC_2.3.4 (2)
     7: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
     8: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (4)
     9: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    10: 0000000000000870   126 FUNC    GLOBAL DEFAULT   14 announcement
    11: 0000000000200de8     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    12: 0000000000000990   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    13: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    14: 00000000000008f0   134 FUNC    GLOBAL DEFAULT   14 main
    15: 0000000000000980     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini

Symbol table '.symtab' contains 76 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000200     0 SECTION LOCAL  DEFAULT    1 
     2: 000000000000021c     0 SECTION LOCAL  DEFAULT    2 
     3: 000000000000023c     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000000260     0 SECTION LOCAL  DEFAULT    4 
     5: 00000000000002b8     0 SECTION LOCAL  DEFAULT    5 
     6: 00000000000002f8     0 SECTION LOCAL  DEFAULT    6 
     7: 0000000000000478     0 SECTION LOCAL  DEFAULT    7 
     8: 000000000000055c     0 SECTION LOCAL  DEFAULT    8 
     9: 0000000000000580     0 SECTION LOCAL  DEFAULT    9 
    10: 00000000000005c0     0 SECTION LOCAL  DEFAULT   10 
    11: 0000000000000680     0 SECTION LOCAL  DEFAULT   11 
    12: 00000000000006f8     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000000710     0 SECTION LOCAL  DEFAULT   13 
    14: 0000000000000770     0 SECTION LOCAL  DEFAULT   14 
    15: 0000000000000a58     0 SECTION LOCAL  DEFAULT   15 
    16: 0000000000000a68     0 SECTION LOCAL  DEFAULT   16 
    17: 0000000000000a7c     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000000ab0     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000200b88     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000200b98     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000200ba8     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000200bb0     0 SECTION LOCAL  DEFAULT   22 
    23: 0000000000200d50     0 SECTION LOCAL  DEFAULT   23 
    24: 0000000000200d88     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000200dc8     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000200dd8     0 SECTION LOCAL  DEFAULT   26 
    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 
    28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28 
    29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29 
    30: 0000000000000000     0 SECTION LOCAL  DEFAULT   30 
    31: 0000000000000000     0 SECTION LOCAL  DEFAULT   31 
    32: 0000000000000000     0 SECTION LOCAL  DEFAULT   32 
    33: 0000000000000000     0 SECTION LOCAL  DEFAULT   33 
    34: 0000000000000000     0 SECTION LOCAL  DEFAULT   34 
    35: 000000000000079c     0 FUNC    LOCAL  DEFAULT   14 call_gmon_start
    36: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    37: 0000000000200b88     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_LIST__
    38: 0000000000200b98     0 OBJECT  LOCAL  DEFAULT   20 __DTOR_LIST__
    39: 0000000000200ba8     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__
    40: 00000000000007c0     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    41: 0000000000200dd8     1 OBJECT  LOCAL  DEFAULT   26 completed.5854
    42: 0000000000200de0     8 OBJECT  LOCAL  DEFAULT   26 dtor_idx.5856
    43: 0000000000000840     0 FUNC    LOCAL  DEFAULT   14 frame_dummy
    44: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    45: 0000000000200b90     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_END__
    46: 0000000000000b80     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__
    47: 0000000000200ba8     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__
    48: 0000000000000a20     0 FUNC    LOCAL  DEFAULT   14 __do_global_ctors_aux
    49: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
    50: 0000000000200b84     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end
    51: 0000000000200bb0     0 OBJECT  LOCAL  DEFAULT  ABS _DYNAMIC
    52: 0000000000200b84     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start
    53: 0000000000200d88     0 OBJECT  LOCAL  DEFAULT  ABS _GLOBAL_OFFSET_TABLE_
    54: 0000000000000980     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini
    55: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@@GLIBC_2.3.4
    56: 0000000000200dc8     0 NOTYPE  WEAK   DEFAULT   25 data_start
    57: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    58: 0000000000000a58     0 FUNC    GLOBAL DEFAULT   15 _fini
    59: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@@GLIBC_2.4
    60: 0000000000200ba0     0 OBJECT  GLOBAL HIDDEN    20 __DTOR_END__
    61: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_2.2.5
    62: 0000000000200dc8     0 NOTYPE  GLOBAL DEFAULT   25 __data_start
    63: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    64: 0000000000200dd0     0 OBJECT  GLOBAL HIDDEN    25 __dso_handle
    65: 0000000000000870   126 FUNC    GLOBAL DEFAULT   14 announcement
    66: 0000000000000a68     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
    67: 0000000000000990   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    68: 0000000000200de8     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    69: 0000000000000770     0 FUNC    GLOBAL DEFAULT   14 _start
    70: 0000000000200dd8     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    71: 00000000000008f0   134 FUNC    GLOBAL DEFAULT   14 main
    72: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@@GLIBC_2.3.4
    73: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    74: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2.5
    75: 00000000000006f8     0 FUNC    GLOBAL DEFAULT   12 _init
# Run twice to show off PIE, if available in kernel
../build-tree/wrapper-test-compiled
../build-tree/wrapper-test-compiled: ok (0x2b58a656f870)
../build-tree/wrapper-test-compiled
../build-tree/wrapper-test-compiled: ok (0x2b07c5fc5870)
# Enable symlink for ld to trick gcc into doing wrapped linking
(cd ../build-tree && ln -s hardened-ld ld)
(cd ../build-tree && ln -s hardened-ld ld.gold)
# Compiler and linker options enabled.
../build-tree/hardened-cc -B ../build-tree/ -g -O2 -O2  -o ../build-tree/wrapper-test-linked hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -fPIE -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -g -O2 -O2 -o ../build-tree/wrapper-test-linked hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-linked /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu /tmp/cc-OQWMxN.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
readelf -ldrsW ../build-tree/wrapper-test-linked

Elf file type is DYN (Shared object file)
Entry point 0x7b0
There are 9 program headers, starting at offset 64

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  PHDR           0x000040 0x0000000000000040 0x0000000000000040 0x0001f8 0x0001f8 R E 0x8
  INTERP         0x000238 0x0000000000000238 0x0000000000000238 0x00001c 0x00001c R   0x1
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
  LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x000bc4 0x000bc4 R E 0x200000
  LOAD           0x000da0 0x0000000000200da0 0x0000000000200da0 0x000270 0x000280 RW  0x200000
  DYNAMIC        0x000dc8 0x0000000000200dc8 0x0000000000200dc8 0x0001c0 0x0001c0 RW  0x8
  NOTE           0x000254 0x0000000000000254 0x0000000000000254 0x000044 0x000044 R   0x4
  GNU_EH_FRAME   0x000abc 0x0000000000000abc 0x0000000000000abc 0x000034 0x000034 R   0x4
  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x8
  GNU_RELRO      0x000da0 0x0000000000200da0 0x0000000000200da0 0x000260 0x000260 R   0x1

 Section to Segment mapping:
  Segment Sections...
   00     
   01     .interp 
   02     .interp .note.ABI-tag .note.gnu.build-id .hash .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame 
   03     .ctors .dtors .jcr .dynamic .got .data .bss 
   04     .dynamic 
   05     .note.ABI-tag .note.gnu.build-id 
   06     .eh_frame_hdr 
   07     
   08     .ctors .dtors .jcr .dynamic .got 

Dynamic section at offset 0xdc8 contains 24 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x730
 0x000000000000000d (FINI)               0xa98
 0x0000000000000004 (HASH)               0x298
 0x000000006ffffef5 (GNU_HASH)           0x2f0
 0x0000000000000005 (STRTAB)             0x4b0
 0x0000000000000006 (SYMTAB)             0x330
 0x000000000000000a (STRSZ)              227 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000015 (DEBUG)              0x0
 0x0000000000000003 (PLTGOT)             0x200f88
 0x0000000000000002 (PLTRELSZ)           120 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x6b8
 0x0000000000000007 (RELA)               0x5f8
 0x0000000000000008 (RELASZ)             192 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x0000000000000018 (BIND_NOW)           
 0x000000006ffffffb (FLAGS_1)            Flags: NOW
 0x000000006ffffffe (VERNEED)            0x5b8
 0x000000006fffffff (VERNEEDNUM)         1
 0x000000006ffffff0 (VERSYM)             0x594
 0x000000006ffffff9 (RELACOUNT)          5
 0x0000000000000000 (NULL)               0x0

Relocation section '.rela.dyn' at offset 0x5f8 contains 8 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200fc8  0000000000000008 R_X86_64_RELATIVE                               00000000000009c0
0000000000200fd8  0000000000000008 R_X86_64_RELATIVE                               00000000000008b0
0000000000200fe0  0000000000000008 R_X86_64_RELATIVE                               00000000000009d0
0000000000200fe8  0000000000000008 R_X86_64_RELATIVE                               0000000000000930
0000000000201008  0000000000000008 R_X86_64_RELATIVE                               0000000000201008
0000000000200fd0  0000000500000006 R_X86_64_GLOB_DAT      0000000000000000 __gmon_start__ + 0
0000000000200ff0  0000000700000006 R_X86_64_GLOB_DAT      0000000000000000 _Jv_RegisterClasses + 0
0000000000200ff8  0000000800000006 R_X86_64_GLOB_DAT      0000000000000000 __cxa_finalize + 0

Relocation section '.rela.plt' at offset 0x6b8 contains 5 entries:
    Offset             Info             Type               Symbol's Value  Symbol's Name + Addend
0000000000200fa0  0000000200000007 R_X86_64_JUMP_SLOT     0000000000000000 __snprintf_chk + 0
0000000000200fa8  0000000300000007 R_X86_64_JUMP_SLOT     0000000000000000 __stack_chk_fail + 0
0000000000200fb0  0000000400000007 R_X86_64_JUMP_SLOT     0000000000000000 __libc_start_main + 0
0000000000200fb8  0000000600000007 R_X86_64_JUMP_SLOT     0000000000000000 __printf_chk + 0
0000000000200fc0  0000000800000007 R_X86_64_JUMP_SLOT     0000000000000000 __cxa_finalize + 0

Symbol table '.dynsym' contains 16 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000238     0 SECTION LOCAL  DEFAULT    1 
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@GLIBC_2.3.4 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@GLIBC_2.4 (3)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (4)
     5: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@GLIBC_2.3.4 (2)
     7: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
     8: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (4)
     9: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    10: 00000000000008b0   126 FUNC    GLOBAL DEFAULT   14 announcement
    11: 0000000000201020     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    12: 00000000000009d0   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    13: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    14: 0000000000000930   134 FUNC    GLOBAL DEFAULT   14 main
    15: 00000000000009c0     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini

Symbol table '.symtab' contains 75 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000238     0 SECTION LOCAL  DEFAULT    1 
     2: 0000000000000254     0 SECTION LOCAL  DEFAULT    2 
     3: 0000000000000274     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000000298     0 SECTION LOCAL  DEFAULT    4 
     5: 00000000000002f0     0 SECTION LOCAL  DEFAULT    5 
     6: 0000000000000330     0 SECTION LOCAL  DEFAULT    6 
     7: 00000000000004b0     0 SECTION LOCAL  DEFAULT    7 
     8: 0000000000000594     0 SECTION LOCAL  DEFAULT    8 
     9: 00000000000005b8     0 SECTION LOCAL  DEFAULT    9 
    10: 00000000000005f8     0 SECTION LOCAL  DEFAULT   10 
    11: 00000000000006b8     0 SECTION LOCAL  DEFAULT   11 
    12: 0000000000000730     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000000750     0 SECTION LOCAL  DEFAULT   13 
    14: 00000000000007b0     0 SECTION LOCAL  DEFAULT   14 
    15: 0000000000000a98     0 SECTION LOCAL  DEFAULT   15 
    16: 0000000000000aa8     0 SECTION LOCAL  DEFAULT   16 
    17: 0000000000000abc     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000000af0     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000200da0     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000200db0     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000200dc0     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000200dc8     0 SECTION LOCAL  DEFAULT   22 
    23: 0000000000200f88     0 SECTION LOCAL  DEFAULT   23 
    24: 0000000000201000     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000201010     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000000000     0 SECTION LOCAL  DEFAULT   26 
    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 
    28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28 
    29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29 
    30: 0000000000000000     0 SECTION LOCAL  DEFAULT   30 
    31: 0000000000000000     0 SECTION LOCAL  DEFAULT   31 
    32: 0000000000000000     0 SECTION LOCAL  DEFAULT   32 
    33: 0000000000000000     0 SECTION LOCAL  DEFAULT   33 
    34: 00000000000007dc     0 FUNC    LOCAL  DEFAULT   14 call_gmon_start
    35: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    36: 0000000000200da0     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_LIST__
    37: 0000000000200db0     0 OBJECT  LOCAL  DEFAULT   20 __DTOR_LIST__
    38: 0000000000200dc0     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__
    39: 0000000000000800     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    40: 0000000000201010     1 OBJECT  LOCAL  DEFAULT   25 completed.5854
    41: 0000000000201018     8 OBJECT  LOCAL  DEFAULT   25 dtor_idx.5856
    42: 0000000000000880     0 FUNC    LOCAL  DEFAULT   14 frame_dummy
    43: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    44: 0000000000200da8     0 OBJECT  LOCAL  DEFAULT   19 __CTOR_END__
    45: 0000000000000bc0     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__
    46: 0000000000200dc0     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__
    47: 0000000000000a60     0 FUNC    LOCAL  DEFAULT   14 __do_global_ctors_aux
    48: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
    49: 0000000000200d9c     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end
    50: 0000000000200dc8     0 OBJECT  LOCAL  DEFAULT  ABS _DYNAMIC
    51: 0000000000200d9c     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start
    52: 0000000000200f88     0 OBJECT  LOCAL  DEFAULT  ABS _GLOBAL_OFFSET_TABLE_
    53: 00000000000009c0     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini
    54: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __snprintf_chk@@GLIBC_2.3.4
    55: 0000000000201000     0 NOTYPE  WEAK   DEFAULT   24 data_start
    56: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
    57: 0000000000000a98     0 FUNC    GLOBAL DEFAULT   15 _fini
    58: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail@@GLIBC_2.4
    59: 0000000000200db8     0 OBJECT  GLOBAL HIDDEN    20 __DTOR_END__
    60: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_2.2.5
    61: 0000000000201000     0 NOTYPE  GLOBAL DEFAULT   24 __data_start
    62: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    63: 0000000000201008     0 OBJECT  GLOBAL HIDDEN    24 __dso_handle
    64: 00000000000008b0   126 FUNC    GLOBAL DEFAULT   14 announcement
    65: 0000000000000aa8     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used
    66: 00000000000009d0   137 FUNC    GLOBAL DEFAULT   14 __libc_csu_init
    67: 0000000000201020     0 NOTYPE  GLOBAL DEFAULT  ABS _end
    68: 00000000000007b0     0 FUNC    GLOBAL DEFAULT   14 _start
    69: 0000000000201010     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
    70: 0000000000000930   134 FUNC    GLOBAL DEFAULT   14 main
    71: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __printf_chk@@GLIBC_2.3.4
    72: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    73: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2.5
    74: 0000000000000730     0 FUNC    GLOBAL DEFAULT   12 _init
# Run twice to show off PIE, if available in kernel
../build-tree/wrapper-test-linked
../build-tree/wrapper-test-linked: ok (0x2b962cd7d8b0)
../build-tree/wrapper-test-linked
../build-tree/wrapper-test-linked: ok (0x2acda0f458b0)
# Check state of hardening features via check script
sh ../hardening-check  ../build-tree/wrapper-test-linked
../build-tree/wrapper-test-linked:
 Position Independent Executable: yes
 Stack protected: yes
 Fortify Source functions: yes
 Read-only relocations: yes
 Immediate binding: yes
# Manually check state of hardening features
# Test PIE
readelf -lW ../build-tree/wrapper-test-linked | grep '^Elf file type is DYN'
Elf file type is DYN (Shared object file)
# Test Stack Protector
nm ../build-tree/wrapper-test-linked | egrep '__stack_chk_fail($|@@GLIBC)'
                 U __stack_chk_fail@@GLIBC_2.4
# Test Fortify
nm ../build-tree/wrapper-test-linked | egrep '__(sn)?printf_chk($|@@GLIBC)'
                 U __printf_chk@@GLIBC_2.3.4
                 U __snprintf_chk@@GLIBC_2.3.4
# Test Format (no-op currently)
# Test for RELRO
readelf -lW ../build-tree/wrapper-test-linked | grep GNU_RELRO
  GNU_RELRO      0x000da0 0x0000000000200da0 0x0000000000200da0 0x000260 0x000260 R   0x1
# Test for BIND_NOW
readelf -dW ../build-tree/wrapper-test-linked | grep BIND_NOW
 0x0000000000000018 (BIND_NOW)           
# Build directly with -fPIC already defined
../build-tree/hardened-cc -B ../build-tree/ -fPIC -g -O2 -O2  -o ../build-tree/wrapper-test-fPIC-direct hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -fPIC -g -O2 -O2 -o ../build-tree/wrapper-test-fPIC-direct hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-fPIC-direct /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu /tmp/cc-wi6HLZ.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
../build-tree/wrapper-test-fPIC-direct
../build-tree/wrapper-test-fPIC-direct: ok (0x2b038bb5e8b0)
# Build .o with -fPIC already defined
../build-tree/hardened-cc -B ../build-tree/ -fPIC -g -O2 -O2  -o ../build-tree/wrapper-test-fPIC.o -c hello.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -fPIC -g -O2 -O2 -o ../build-tree/wrapper-test-fPIC.o -c hello.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
# Link .o with -fPIC already defined
../build-tree/hardened-cc -B ../build-tree/ -fPIC -g -O2 -O2  -o ../build-tree/wrapper-test-fPIC ../build-tree/wrapper-test-fPIC.o
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -fPIC -g -O2 -O2 -o ../build-tree/wrapper-test-fPIC ../build-tree/wrapper-test-fPIC.o
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-fPIC /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu ../build-tree/wrapper-test-fPIC.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
../build-tree/wrapper-test-fPIC
../build-tree/wrapper-test-fPIC: ok (0x2ac0f7e758b0)
# Make sure build fails due to -Werror=format-security
! ../build-tree/hardened-cc -B ../build-tree/ -g -O2 -O2  -o ../build-tree/wrapper-test-format-security format.c
/usr/bin/clang -fstack-protector --param ssp-buffer-size=4 -fPIE -pie -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -B ../build-tree/ -g -O2 -O2 -o ../build-tree/wrapper-test-format-security format.c
clang: warning: argument unused during compilation: '--param ssp-buffer-size=4'
/usr/bin/ld.bfd -z relro -z now -pie --hash-style=both --no-copy-dt-needed-entries --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o ../build-tree/wrapper-test-format-security /usr/lib/x86_64-linux-gnu/Scrt1.o /usr/lib/x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtbeginS.o -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../.. -L/usr/lib/x86_64-linux-gnu /tmp/cc-p40Nli.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/4.6.1/crtendS.o /usr/lib/x86_64-linux-gnu/crtn.o
make[2]: *** [../build-tree/wrapper-test-format-security] Error 1
make[1]: *** [check] Error 2
make[2]: Leaving directory `/build/hardening-wrapper-0Xyekl/hardening-wrapper-1.34/tests'
make[1]: Leaving directory `/build/hardening-wrapper-0Xyekl/hardening-wrapper-1.34/tests'
make: *** [test-stamp] Error 2
dpkg-buildpackage: error: debian/rules build gave error exit status 2
────────────────────────────────────────────────────────────────────────────────
Build finished at 20110911-1634

Finished
────────

E: Build failure (dpkg-buildpackage died)

┌──────────────────────────────────────────────────────────────────────────────┐
│ Cleanup                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘

Purging /var/lib/schroot/mount/lsid64c-8b992ee0-5c8b-40cb-9b0e-0916ce084843/build/hardening-wrapper-0Xyekl
Not cleaning session: cloned chroot in use

┌──────────────────────────────────────────────────────────────────────────────┐
│ Summary                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘

Architecture: amd64
Build-Space: 256
Build-Time: 2
Distribution: lsid64c
Fail-Stage: build
Install-Time: 5
Job: hardening-wrapper_1.34
Package: hardening-wrapper
Package-Time: 20
Source-Version: 1.34
Space: 256
Status: attempted
Version: 1.34
────────────────────────────────────────────────────────────────────────────────
Finished at 20110911-1634
Build needed 00:00:20, 256k disc space
DC-Build-Status: Failed 657.442976s
### Content of /var/log/daemon.log ###
Sep 11 10:47:53 talc-110 approx: Concurrent download of debian/dists/sid/Release.gpg is taking too long
Sep 11 10:48:04 talc-110 approx: Concurrent download of debian/dists/sid/Release.gpg is taking too long
Sep 11 10:48:44 talc-110 approx: Concurrent download of debian/dists/sid/Release is taking too long
Sep 11 10:48:51 talc-110 approx: Concurrent download of debian/dists/sid/main/binary-amd64/Packages.xz is taking too long
Sep 11 10:48:57 talc-110 approx: Concurrent download of debian/dists/sid/Release is taking too long
Sep 11 10:49:08 talc-110 approx: Concurrent download of debian/dists/sid/main/binary-amd64/Packages.xz is taking too long
Sep 11 10:49:08 talc-110 approx: Concurrent download of debian/dists/sid/Release is taking too long
Sep 11 10:49:18 talc-110 approx: Concurrent download of debian/dists/sid/main/source/Sources.xz is taking too long
Sep 11 10:49:19 talc-110 approx: Concurrent download of debian/dists/sid/main/binary-amd64/Packages.xz is taking too long
Sep 11 10:49:29 talc-110 approx: Concurrent download of debian/dists/sid/main/i18n/Index is taking too long
Sep 11 10:49:45 talc-110 approx: Concurrent download of debian/dists/sid/main/binary-amd64/Packages.xz is taking too long
Sep 11 12:37:46 talc-110 approx: Concurrent download of debian/dists/sid/main/i18n/Translation-en.gz is taking too long
Sep 11 13:19:21 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:23:53 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:23:53 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:26:39 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:26:39 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:26:39 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:28:50 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:31:23 talc-110 approx: Nethttpd: Broken pipe
Sep 11 13:32:09 talc-110 approx: Nethttpd: Broken pipe
Sep 11 14:28:08 talc-110 approx: Concurrent download of debian/dists/sid/Release.gpg is taking too long
Sep 11 14:54:45 talc-110 approx: Nethttpd: Broken pipe
Sep 11 14:55:47 talc-110 approx: Nethttpd: Broken pipe
Sep 11 14:57:12 talc-110 approx: Nethttpd: Broken pipe
### End of content of /var/log/daemon.log ###
DC-Time-Estimation: 657.442976 versus expected 14 (r/m: 45.9602125714286 ; m: 14.0)
